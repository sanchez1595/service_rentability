(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{48312:function(e,a,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(56263)}])},56263:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return ax}});var t=s(85893),r=s(9008),l=s.n(r),o=s(67294),i=s(11163),n=s(95770);let c=e=>{let{children:a}=e,{user:s,loading:r}=(0,n.a)(),l=(0,i.useRouter)();return((0,o.useEffect)(()=>{r||s||l.push("/auth")},[s,r,l]),r)?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Verificando autenticaci\xf3n..."})]})}):s?(0,t.jsx)(t.Fragment,{children:a}):null};var d=s(37843);let m={async obtenerTodos(){let{data:e,error:a}=await d.O.from("clientes").select("*").order("nombre");if(a)throw a;return(e||[]).map(e=>({...e,created_at:e.created_at,updated_at:e.updated_at}))},async obtenerPorId(e){let{data:a,error:s}=await d.O.from("clientes").select("*").eq("id",e).single();if(s)throw s;return a},async crear(e){let{data:a,error:s}=await d.O.from("clientes").insert([e]).select().single();if(s)throw s;return a},async actualizar(e,a){let{data:s,error:t}=await d.O.from("clientes").update(a).eq("id",e).select().single();if(t)throw t;return s},async eliminar(e){let{error:a}=await d.O.from("clientes").delete().eq("id",e);if(a)throw a}},x={async obtenerTodos(){let{data:e,error:a}=await d.O.from("servicios").select("*").eq("activo",!0).order("categoria").order("nombre");if(a)throw a;return(e||[]).map(e=>({...e,costoBase:e.costo_base||0,gastosFijos:e.gastos_fijos||0,margenDeseado:e.margen_deseado||30,precioSugerido:e.precio_sugerido||0,duracionEstimada:e.duracion_estimada||1,tipoServicio:e.tipo_servicio||"unico",precioPorHora:e.precio_por_hora||0,recursosNecesarios:e.recursos_necesarios,vecesCotizado:e.veces_cotizado||0,vecesVendido:e.veces_vendido||0}))},async crear(e){let{data:a,error:s}=await d.O.from("servicios").insert([{nombre:e.nombre,categoria:e.categoria,descripcion:e.descripcion,costo_base:parseFloat(e.costoBase)||0,gastos_fijos:parseFloat(e.gastosFijos)||0,margen_deseado:parseFloat(e.margenDeseado)||30,precio_sugerido:parseFloat(e.precioSugerido)||0,duracion_estimada:"string"==typeof e.duracionEstimada?parseInt(e.duracionEstimada)||1:e.duracionEstimada||1,tipo_servicio:e.tipoServicio,precio_por_hora:e.precioPorHora?parseFloat(e.precioPorHora):null,recursos_necesarios:e.recursosNecesarios,activo:e.activo}]).select().single();if(s)throw s;return a},async actualizar(e,a){let s={};void 0!==a.nombre&&(s.nombre=a.nombre),void 0!==a.categoria&&(s.categoria=a.categoria),void 0!==a.descripcion&&(s.descripcion=a.descripcion),void 0!==a.costoBase&&(s.costo_base=parseFloat(a.costoBase)),void 0!==a.gastosFijos&&(s.gastos_fijos=parseFloat(a.gastosFijos)),void 0!==a.margenDeseado&&(s.margen_deseado=parseFloat(a.margenDeseado)),void 0!==a.precioSugerido&&(s.precio_sugerido=parseFloat(a.precioSugerido)),void 0!==a.duracionEstimada&&(s.duracion_estimada=parseInt(a.duracionEstimada.toString())||1),void 0!==a.tipoServicio&&(s.tipo_servicio=a.tipoServicio),void 0!==a.precioPorHora&&(s.precio_por_hora=parseFloat(a.precioPorHora)),void 0!==a.recursosNecesarios&&(s.recursos_necesarios=a.recursosNecesarios),void 0!==a.activo&&(s.activo=a.activo);let{data:t,error:r}=await d.O.from("servicios").update(s).eq("id",e).select().single();if(r)throw r;return t},async eliminar(e){let{error:a}=await d.O.from("servicios").update({activo:!1}).eq("id",e);if(a)throw a}},p={async obtenerTodas(){let{data:e,error:a}=await d.O.from("cotizaciones").select("\n        *,\n        cliente:clientes(nombre, empresa),\n        items:items_cotizacion(\n          *,\n          servicio:servicios(nombre)\n        )\n      ").order("fecha",{ascending:!1});if(a)throw a;return(e||[]).map(e=>{var a,s,t;return{...e,clienteNombre:(null===(a=e.cliente)||void 0===a?void 0:a.nombre)||"",clienteEmpresa:(null===(s=e.cliente)||void 0===s?void 0:s.empresa)||"",items:null===(t=e.items)||void 0===t?void 0:t.map(e=>{var a;return{...e,servicioNombre:(null===(a=e.servicio)||void 0===a?void 0:a.nombre)||""}})}})},async obtenerPorId(e){let{data:a,error:s}=await d.O.from("cotizaciones").select("\n        *,\n        cliente:clientes(*),\n        items:items_cotizacion(\n          *,\n          servicio:servicios(*)\n        )\n      ").eq("id",e).single();if(s)throw s;return a},async generarNumero(){let e=new Date().getFullYear(),{data:a,error:s}=await d.O.from("cotizaciones").select("numero").like("numero","QUOTE-".concat(e,"-%")).order("numero",{ascending:!1}).limit(1);if(s)throw s;let t=1;return a&&a.length>0&&(t=parseInt(a[0].numero.split("-").pop())+1),"QUOTE-".concat(e,"-").concat(t.toString().padStart(3,"0"))},async crear(e,a){try{let s={numero:await this.generarNumero(),cliente_id:e.clienteId,fecha:e.fecha,fecha_validez:e.fechaValidez,estado:e.estado||"borrador",subtotal:parseFloat(e.subtotal)||0,descuento_porcentaje:parseFloat(e.descuentoPorcentaje)||0,descuento_valor:parseFloat(e.descuentoValor)||0,iva:parseFloat(e.iva)||0,total:parseFloat(e.total)||0,notas:e.notas||"",terminos_condiciones:e.terminosCondiciones||""};console.log("Datos a insertar en cotizaci\xf3n:",s);let{data:t,error:r}=await d.O.from("cotizaciones").insert([s]).select().single();if(r)throw console.error("Error al crear cotizaci\xf3n:",r),r;if(a&&a.length>0){let e=a.map((e,a)=>({cotizacion_id:t.id,servicio_id:e.servicioId,descripcion:e.descripcion,cantidad:parseFloat(e.cantidad)||1,precio_unitario:parseFloat(e.precioUnitario)||0,descuento_porcentaje:parseFloat(e.descuentoPorcentaje)||0,subtotal:parseFloat(e.subtotal)||0,notas:e.notas||"",orden:a}));console.log("Datos a insertar en items:",e);let{error:s}=await d.O.from("items_cotizacion").insert(e);if(s)throw console.error("Error al crear items de cotizaci\xf3n:",s),s;for(let e of Array.from(new Set(a.map(e=>e.servicioId).filter(e=>e))))try{await d.O.rpc("incrementar_veces_cotizado",{servicio_id:e})}catch(e){console.warn("Error al incrementar contador de cotizaciones:",e)}}return t}catch(e){throw console.error("Error completo al crear cotizaci\xf3n:",e),e}},async actualizar(e,a){let s={};void 0!==a.estado&&(s.estado=a.estado),void 0!==a.notas&&(s.notas=a.notas),void 0!==a.fechaAprobacion&&(s.fecha_aprobacion=a.fechaAprobacion),void 0!==a.fechaRechazo&&(s.fecha_rechazo=a.fechaRechazo),void 0!==a.motivoRechazo&&(s.motivo_rechazo=a.motivoRechazo);let{data:t,error:r}=await d.O.from("cotizaciones").update(s).eq("id",e).select().single();if(r)throw r;return t},async aprobar(e){let a=await this.obtenerPorId(e);if(!a)throw Error("Cotizaci\xf3n no encontrada");await this.actualizar(e,{estado:"aprobada",fechaAprobacion:new Date().toISOString().split("T")[0]});let s=await h.crearDesdeCoizacion(a);if(a.items)for(let e of Array.from(new Set(a.items.map(e=>e.servicio_id))))await d.O.rpc("incrementar_veces_vendido",{servicio_id:e});return s},async rechazar(e,a){return this.actualizar(e,{estado:"rechazada",fechaRechazo:new Date().toISOString().split("T")[0],motivoRechazo:a})},async eliminar(e){await d.O.from("items_cotizacion").delete().eq("cotizacion_id",e);let{error:a}=await d.O.from("cotizaciones").delete().eq("id",e);if(a)throw a}},h={async obtenerTodos(){let{data:e,error:a}=await d.O.from("proyectos").select("\n        *,\n        cliente:clientes(nombre, empresa),\n        cotizacion:cotizaciones(numero),\n        planes_pago(*)\n      ").order("fecha_inicio",{ascending:!1});if(a)throw a;return(e||[]).map(e=>{var a,s;return{...e,clienteNombre:(null===(a=e.cliente)||void 0===a?void 0:a.nombre)||"",cotizacionNumero:(null===(s=e.cotizacion)||void 0===s?void 0:s.numero)||""}})},async obtenerPorId(e){let{data:a,error:s}=await d.O.from("proyectos").select("\n        *,\n        cliente:clientes(*),\n        cotizacion:cotizaciones(*),\n        planes_pago(*),\n        pagos(*),\n        desembolsos(*)\n      ").eq("id",e).single();if(s)throw s;return a},async crearDesdeCoizacion(e){let{data:a,error:s}=await d.O.from("proyectos").insert([{cotizacion_id:e.id,cliente_id:e.cliente_id,nombre:"Proyecto ".concat(e.numero),fecha_inicio:new Date().toISOString().split("T")[0],fecha_fin_estimada:this.calcularFechaFin(e),estado:"activo",valor_total:e.total,costo_estimado:this.calcularCostoEstimado(e),rentabilidad_estimada:e.total-this.calcularCostoEstimado(e)}]).select().single();if(s)throw s;return a},calcularFechaFin(e){let a=30;if(e.items){let s=e.items.filter(e=>{var a;return null===(a=e.servicio)||void 0===a?void 0:a.duracion_estimada}).map(e=>e.servicio.duracion_estimada);s.length>0&&(a=Math.max(...s))}let s=new Date;return s.setDate(s.getDate()+a),s.toISOString().split("T")[0]},calcularCostoEstimado(e){let a=0;return e.items&&e.items.forEach(e=>{if(e.servicio){let s=parseFloat(e.servicio.costo_base)||0,t=parseFloat(e.servicio.gastos_fijos)||0;a+=(s+t)*e.cantidad}}),a},async actualizar(e,a){let s={};void 0!==a.nombre&&(s.nombre=a.nombre),void 0!==a.fechaFinReal&&(s.fecha_fin_real=a.fechaFinReal),void 0!==a.estado&&(s.estado=a.estado),void 0!==a.progreso&&(s.progreso=a.progreso),void 0!==a.costoReal&&(s.costo_real=a.costoReal),void 0!==a.rentabilidadReal&&(s.rentabilidad_real=a.rentabilidadReal),void 0!==a.notas&&(s.notas=a.notas);let{data:t,error:r}=await d.O.from("proyectos").update(s).eq("id",e).select().single();if(r)throw r;return t},async actualizarProgreso(e,a){return this.actualizar(e,{progreso:a})},async completar(e){var a,s;let t=await this.obtenerPorId(e);if(!t)throw Error("Proyecto no encontrado");let r=(null===(a=t.pagos)||void 0===a?void 0:a.reduce((e,a)=>e+a.monto,0))||0,l=(null===(s=t.desembolsos)||void 0===s?void 0:s.reduce((e,a)=>e+a.monto,0))||0;return this.actualizar(e,{estado:"completado",fechaFinReal:new Date().toISOString().split("T")[0],progreso:100,costoReal:l,rentabilidadReal:r-l})}},u={async obtenerPorProyecto(e){let{data:a,error:s}=await d.O.from("planes_pago").select("*").eq("proyecto_id",e).order("numero_cuota");if(s)throw s;return a||[]},async crear(e){let{data:a,error:s}=await d.O.from("planes_pago").insert([{proyecto_id:e.proyectoId,numero_cuota:e.numeroCuota,descripcion:e.descripcion,fecha_vencimiento:e.fechaVencimiento,monto:e.monto,tipo:e.tipo,porcentaje_proyecto:e.porcentajeProyecto,estado:e.estado}]).select().single();if(s)throw s;return a},async crearMultiples(e){let a=e.map(e=>({proyecto_id:e.proyectoId,numero_cuota:e.numeroCuota,descripcion:e.descripcion,fecha_vencimiento:e.fechaVencimiento,monto:e.monto,tipo:e.tipo,porcentaje_proyecto:e.porcentajeProyecto,estado:e.estado})),{data:s,error:t}=await d.O.from("planes_pago").insert(a).select();if(t)throw t;return s},async actualizar(e,a){let s={};void 0!==a.fechaVencimiento&&(s.fecha_vencimiento=a.fechaVencimiento),void 0!==a.monto&&(s.monto=a.monto),void 0!==a.estado&&(s.estado=a.estado);let{data:t,error:r}=await d.O.from("planes_pago").update(s).eq("id",e).select().single();if(r)throw r;return t},async marcarComoPagado(e){return this.actualizar(e,{estado:"pagado"})},async verificarVencimientos(){let e=new Date().toISOString().split("T")[0],{data:a,error:s}=await d.O.from("planes_pago").update({estado:"vencido"}).eq("estado","pendiente").lt("fecha_vencimiento",e).select();if(s)throw s;return a}},b={async obtenerPorProyecto(e){let{data:a,error:s}=await d.O.from("pagos").select("\n        *,\n        plan_pago:planes_pago(descripcion, numero_cuota)\n      ").eq("proyecto_id",e).order("fecha",{ascending:!1});if(s)throw s;return a||[]},async crear(e){let{data:a,error:s}=await d.O.from("pagos").insert([{proyecto_id:e.proyectoId,plan_pago_id:e.planPagoId,fecha:e.fecha,monto:e.monto,metodo_pago:e.metodoPago,numero_referencia:e.numeroReferencia,notas:e.notas}]).select().single();if(s)throw s;return e.planPagoId&&await this.actualizarEstadoPlanPago(e.planPagoId),a},async actualizarEstadoPlanPago(e){let{data:a,error:s}=await d.O.from("planes_pago").select("monto").eq("id",e).single();if(s)throw s;let{data:t,error:r}=await d.O.from("pagos").select("monto").eq("plan_pago_id",e);if(r)throw r;let l=(null==t?void 0:t.reduce((e,a)=>e+a.monto,0))||0,o="pendiente";l>=a.monto?o="pagado":l>0&&(o="parcial"),await u.actualizar(e,{estado:o})},async eliminar(e){let{data:a,error:s}=await d.O.from("pagos").select("plan_pago_id").eq("id",e).single();if(s)throw s;let{error:t}=await d.O.from("pagos").delete().eq("id",e);if(t)throw t;a.plan_pago_id&&await this.actualizarEstadoPlanPago(a.plan_pago_id)}},g={async obtenerTodas(){let{data:e,error:a}=await d.O.from("categorias_desembolso").select("*").order("nombre");if(a)throw a;return e||[]},async crear(e){let{data:a,error:s}=await d.O.from("categorias_desembolso").insert([e]).select().single();if(s)throw s;return a}},j={async obtenerPorProyecto(e){let{data:a,error:s}=await d.O.from("desembolsos").select("\n        *,\n        categoria:categorias_desembolso(nombre)\n      ").eq("proyecto_id",e).order("fecha",{ascending:!1});if(s)throw s;return(a||[]).map(e=>{var a;return{...e,categoriaNombre:(null===(a=e.categoria)||void 0===a?void 0:a.nombre)||""}})},async obtenerTodos(){let{data:e,error:a}=await d.O.from("desembolsos").select("\n        *,\n        categoria:categorias_desembolso(nombre),\n        proyecto:proyectos(nombre)\n      ").order("fecha",{ascending:!1});if(a)throw a;return(e||[]).map(e=>{var a,s;return{...e,categoriaNombre:(null===(a=e.categoria)||void 0===a?void 0:a.nombre)||"",proyectoNombre:(null===(s=e.proyecto)||void 0===s?void 0:s.nombre)||"Gasto general"}})},async crear(e){let{data:a,error:s}=await d.O.from("desembolsos").insert([{proyecto_id:e.proyectoId,categoria_id:e.categoriaId,fecha:e.fecha,descripcion:e.descripcion,monto:e.monto,proveedor:e.proveedor,numero_factura:e.numeroFactura,metodo_pago:e.metodoPago,estado:e.estado,aprobado_por:e.aprobadoPor,notas:e.notas}]).select().single();if(s)throw s;return e.proyectoId&&"pagado"===e.estado&&await this.actualizarCostoProyecto(e.proyectoId),a},async actualizarCostoProyecto(e){let{data:a,error:s}=await d.O.from("desembolsos").select("monto").eq("proyecto_id",e).eq("estado","pagado");if(s)throw s;let t=(null==a?void 0:a.reduce((e,a)=>e+a.monto,0))||0;await h.actualizar(e,{costoReal:t})},async actualizar(e,a){let s={};void 0!==a.estado&&(s.estado=a.estado),void 0!==a.aprobadoPor&&(s.aprobado_por=a.aprobadoPor),void 0!==a.notas&&(s.notas=a.notas);let{data:t,error:r}=await d.O.from("desembolsos").update(s).eq("id",e).select().single();if(r)throw r;return a.estado&&t.proyecto_id&&await this.actualizarCostoProyecto(t.proyecto_id),t},async eliminar(e){let{data:a,error:s}=await d.O.from("desembolsos").select("proyecto_id").eq("id",e).single();if(s)throw s;let{error:t}=await d.O.from("desembolsos").delete().eq("id",e);if(t)throw t;a.proyecto_id&&await this.actualizarCostoProyecto(a.proyecto_id)}},f={async obtenerToda(){try{let{data:e,error:a}=await d.O.from("configuracion").select("*");if(a)throw a;let s={porcentajes:{},costosFijos:{},herramientas:{},ventasEstimadas:0,empresa:{nombre:"Mi Empresa SAS",nit:"123456789-0",direccion:"Calle 123 #45-67",telefono:"+57 300 123 4567",email:"contacto@miempresa.com",ciudad:"Bogot\xe1, Colombia"},cotizaciones:{validezDias:30,ivaDefecto:19,terminosCondiciones:"1. Validez de la cotizaci\xf3n: 30 d\xedas a partir de la fecha de emisi\xf3n.\n2. Forma de pago: 50% anticipo, 50% contra entrega.\n3. Los precios no incluyen IVA.\n4. Cualquier trabajo adicional ser\xe1 cotizado por separado.\n5. El tiempo de entrega est\xe1 sujeto a la aprobaci\xf3n de la cotizaci\xf3n.",notaPie:"Gracias por confiar en nosotros",mostrarLogo:!1,formatoNumero:"QUOTE-{YYYY}-{###}"}};return null==e||e.forEach(e=>{"porcentaje"===e.tipo?s.porcentajes[e.clave]=e.valor:"costo_fijo"===e.tipo?s.costosFijos[e.clave]=e.valor:"herramienta"===e.tipo?s.herramientas[e.clave]=e.valor:"general"===e.tipo&&"ventas_estimadas"===e.clave?s.ventasEstimadas=e.valor:"empresa"===e.tipo?s.empresa[e.clave]="string"==typeof e.valor?e.valor:e.valor_texto||"":"cotizaciones"===e.tipo&&(["validezDias","ivaDefecto"].includes(e.clave)?s.cotizaciones[e.clave]=e.valor:s.cotizaciones[e.clave]=e.valor_texto||"")}),s}catch(e){throw console.error("Error obteniendo configuraci\xf3n:",e),e}},async actualizar(e,a,s){try{let{error:t}=await d.O.from("configuracion").upsert({tipo:e,clave:a,valor:s},{onConflict:"tipo,clave"});if(t)throw t}catch(e){throw console.error("Error actualizando configuraci\xf3n:",e),e}},async actualizarTexto(e,a,s){try{let{error:t}=await d.O.from("configuracion").upsert({tipo:e,clave:a,valor:0,valor_texto:s},{onConflict:"tipo,clave"});if(t)throw t}catch(e){throw console.error("Error actualizando configuraci\xf3n de texto:",e),e}},async actualizarEmpresa(e){try{for(let a of Object.entries(e).map(e=>{let[a,s]=e;return{tipo:"empresa",clave:a,valor_texto:s||""}}))await this.actualizarTexto(a.tipo,a.clave,a.valor_texto)}catch(e){throw console.error("Error actualizando configuraci\xf3n de empresa:",e),e}},async actualizarCotizaciones(e){try{for(let[a,s]of Object.entries(e))"number"==typeof s?await this.actualizar("cotizaciones",a,s):"string"==typeof s?await this.actualizarTexto("cotizaciones",a,s):"boolean"==typeof s&&await this.actualizar("cotizaciones",a,s?1:0)}catch(e){throw console.error("Error actualizando configuraci\xf3n de cotizaciones:",e),e}},async actualizarCompleta(e){try{e.empresa&&await this.actualizarEmpresa(e.empresa),e.cotizaciones&&await this.actualizarCotizaciones(e.cotizaciones),void 0!==e.ventasEstimadas&&await this.actualizar("general","ventas_estimadas",e.ventasEstimadas)}catch(e){throw console.error("Error actualizando configuraci\xf3n completa:",e),e}},async eliminar(e,a){try{let{error:s}=await d.O.from("configuracion").delete().eq("tipo",e).eq("clave",a);if(s)throw s}catch(e){throw console.error("Error eliminando configuraci\xf3n:",e),e}}},v={async obtenerTodas(){try{let{data:e,error:a}=await d.O.from("metas").select("*");if(a)throw a;let s={ventasMensuales:0,unidadesMensuales:0,margenPromedio:0,rotacionInventario:0};return null==e||e.forEach(e=>{switch(e.clave){case"ventas_mensuales":s.ventasMensuales=e.valor;break;case"unidades_mensuales":s.unidadesMensuales=e.valor;break;case"margen_promedio":s.margenPromedio=e.valor;break;case"rotacion_inventario":s.rotacionInventario=e.valor}}),s}catch(e){throw console.error("Error obteniendo metas:",e),e}},async actualizar(e,a){try{let{error:s}=await d.O.from("metas").upsert({clave:e,valor:a},{onConflict:"clave"});if(s)throw s}catch(e){throw console.error("Error actualizando meta:",e),e}}},N={async obtenerTodas(){try{let{data:e,error:a}=await d.O.from("alertas").select("*");if(a)throw a;let s={margenMinimo:0,stockMinimo:0,diasSinVenta:0,diferenciaPrecioCompetencia:0};return null==e||e.forEach(e=>{switch(e.clave){case"margen_minimo":s.margenMinimo=e.valor;break;case"stock_minimo":s.stockMinimo=e.valor;break;case"dias_sin_venta":s.diasSinVenta=e.valor;break;case"diferencia_precio_competencia":s.diferenciaPrecioCompetencia=e.valor}}),s}catch(e){throw console.error("Error obteniendo alertas:",e),e}},async actualizar(e,a){try{let{error:s}=await d.O.from("alertas").upsert({clave:e,valor:a},{onConflict:"clave"});if(s)throw s}catch(e){throw console.error("Error actualizando alerta:",e),e}}},y=async()=>await f.obtenerToda(),w=async()=>await v.obtenerTodas(),C=async()=>await N.obtenerTodas(),E=async(e,a,s)=>await f.actualizar(e,a,s),z=async(e,a)=>await f.eliminar(e,a),S=async(e,a)=>await v.actualizar(e,a),D=async(e,a)=>await N.actualizar(e,a),P={clientes:[],servicios:[],cotizaciones:[],proyectos:[],planesPago:[],pagos:[],categoriasDesembolso:[],desembolsos:[],configuracion:{porcentajes:{contabilidad:2,mercadeo:5,ventas:15,salarios:10,compras:2,extras:5},costosFijos:{arriendo:1e6,energia:2e5,gas:5e4,aseo:8e5,internet:2e5,agua:2e5,servidores:11e4},herramientas:{figma:51600,chatgpt:86e3,correos:51600,servidor:1e5,dominio:12e4},ventasEstimadas:100,empresa:{nombre:"Mi Empresa SAS",nit:"123456789-0",direccion:"Calle 123 #45-67",telefono:"+57 300 123 4567",email:"contacto@miempresa.com",ciudad:"Bogot\xe1, Colombia"},cotizaciones:{validezDias:30,ivaDefecto:19,terminosCondiciones:"1. Validez de la cotizaci\xf3n: 30 d\xedas a partir de la fecha de emisi\xf3n.\n2. Forma de pago: 50% anticipo, 50% contra entrega.\n3. Los precios no incluyen IVA.\n4. Cualquier trabajo adicional ser\xe1 cotizado por separado.\n5. El tiempo de entrega est\xe1 sujeto a la aprobaci\xf3n de la cotizaci\xf3n.",notaPie:"Gracias por confiar en nosotros",mostrarLogo:!1,formatoNumero:"QUOTE-{YYYY}-{###}"}},metas:{ventasMensuales:5e6,unidadesMensuales:20,margenPromedio:40,rotacionInventario:6},alertas:{margenMinimo:25,stockMinimo:5,diasSinVenta:30,diferenciaPrecioCompetencia:15},metricas:null,loading:!0,error:null};function _(e,a){switch(a.type){case"SET_LOADING":return{...e,loading:a.payload};case"SET_ERROR":return{...e,error:a.payload,loading:!1};case"SET_CLIENTES":return{...e,clientes:a.payload};case"ADD_CLIENTE":return{...e,clientes:[...e.clientes,a.payload]};case"UPDATE_CLIENTE":return{...e,clientes:e.clientes.map(e=>e.id===a.payload.id?a.payload.cliente:e)};case"REMOVE_CLIENTE":return{...e,clientes:e.clientes.filter(e=>e.id!==a.payload)};case"SET_SERVICIOS":return{...e,servicios:a.payload};case"ADD_SERVICIO":return{...e,servicios:[...e.servicios,a.payload]};case"UPDATE_SERVICIO":return{...e,servicios:e.servicios.map(e=>e.id===a.payload.id?a.payload.servicio:e)};case"REMOVE_SERVICIO":return{...e,servicios:e.servicios.filter(e=>e.id!==a.payload)};case"SET_COTIZACIONES":return{...e,cotizaciones:a.payload};case"ADD_COTIZACION":return{...e,cotizaciones:[a.payload,...e.cotizaciones]};case"UPDATE_COTIZACION":return{...e,cotizaciones:e.cotizaciones.map(e=>e.id===a.payload.id?a.payload.cotizacion:e)};case"REMOVE_COTIZACION":return{...e,cotizaciones:e.cotizaciones.filter(e=>e.id!==a.payload)};case"SET_PROYECTOS":return{...e,proyectos:a.payload};case"ADD_PROYECTO":return{...e,proyectos:[a.payload,...e.proyectos]};case"UPDATE_PROYECTO":return{...e,proyectos:e.proyectos.map(e=>e.id===a.payload.id?a.payload.proyecto:e)};case"SET_PLANES_PAGO":return{...e,planesPago:a.payload};case"ADD_PLAN_PAGO":return{...e,planesPago:[...e.planesPago,a.payload]};case"UPDATE_PLAN_PAGO":return{...e,planesPago:e.planesPago.map(e=>e.id===a.payload.id?a.payload.plan:e)};case"SET_PAGOS":return{...e,pagos:a.payload};case"ADD_PAGO":return{...e,pagos:[a.payload,...e.pagos]};case"REMOVE_PAGO":return{...e,pagos:e.pagos.filter(e=>e.id!==a.payload)};case"SET_CATEGORIAS_DESEMBOLSO":return{...e,categoriasDesembolso:a.payload};case"ADD_CATEGORIA_DESEMBOLSO":return{...e,categoriasDesembolso:[...e.categoriasDesembolso,a.payload]};case"SET_DESEMBOLSOS":return{...e,desembolsos:a.payload};case"ADD_DESEMBOLSO":return{...e,desembolsos:[a.payload,...e.desembolsos]};case"UPDATE_DESEMBOLSO":return{...e,desembolsos:e.desembolsos.map(e=>e.id===a.payload.id?a.payload.desembolso:e)};case"REMOVE_DESEMBOLSO":return{...e,desembolsos:e.desembolsos.filter(e=>e.id!==a.payload)};case"SET_CONFIGURACION":return{...e,configuracion:a.payload};case"SET_METAS":return{...e,metas:a.payload};case"SET_ALERTAS":return{...e,alertas:a.payload};case"SET_METRICAS":return{...e,metricas:a.payload};default:return e}}let T=(0,o.createContext)(void 0);function F(e){let{children:a}=e,[s,r]=(0,o.useReducer)(_,P),l=()=>{let e=new Date,a=new Date(e.getFullYear(),e.getMonth(),1),t=s.cotizaciones.filter(e=>new Date(e.fecha)>=a),l=t.filter(e=>["enviada","aprobada"].includes(e.estado)).length,o=t.filter(e=>"aprobada"===e.estado).length,i=s.pagos.filter(e=>new Date(e.fecha)>=a).reduce((e,a)=>e+a.monto,0),n=s.desembolsos.filter(e=>new Date(e.fecha)>=a&&"pagado"===e.estado).reduce((e,a)=>e+a.monto,0),c=i-n,d=s.proyectos.filter(e=>"activo"===e.estado).length,m=new Date().toISOString().split("T")[0];r({type:"SET_METRICAS",payload:{cotizacionesEnviadas:l,cotizacionesAprobadas:o,tasaConversion:l>0?o/l*100:0,ingresosMes:i,gastosMes:n,utilidadMes:c,proyectosActivos:d,pagosVencidos:s.planesPago.filter(e=>"pendiente"===e.estado&&e.fechaVencimiento<m).length,flujoEfectivo:c}})},i=async()=>{try{r({type:"SET_LOADING",payload:!0});let[e,a,s,t,l,o,i,n,c]=await Promise.all([m.obtenerTodos(),x.obtenerTodos(),p.obtenerTodas(),h.obtenerTodos(),g.obtenerTodas(),j.obtenerTodos(),y(),w(),C()]);if(r({type:"SET_CLIENTES",payload:e}),r({type:"SET_SERVICIOS",payload:a}),r({type:"SET_COTIZACIONES",payload:s}),r({type:"SET_PROYECTOS",payload:t}),r({type:"SET_CATEGORIAS_DESEMBOLSO",payload:l}),r({type:"SET_DESEMBOLSOS",payload:o}),r({type:"SET_CONFIGURACION",payload:i}),r({type:"SET_METAS",payload:n}),r({type:"SET_ALERTAS",payload:c}),t.length>0){let e=[],a=[];for(let s of t){let[t,r]=await Promise.all([u.obtenerPorProyecto(s.id),b.obtenerPorProyecto(s.id)]);e.push(...t),a.push(...r)}r({type:"SET_PLANES_PAGO",payload:e}),r({type:"SET_PAGOS",payload:a})}r({type:"SET_ERROR",payload:null})}catch(e){console.error("Error cargando datos:",e),r({type:"SET_ERROR",payload:e.message})}finally{r({type:"SET_LOADING",payload:!1})}};(0,o.useEffect)(()=>{i()},[]),(0,o.useEffect)(()=>{s.loading||l()},[s.cotizaciones,s.pagos,s.desembolsos,s.proyectos,s.planesPago,s.loading]);let n=async e=>{r({type:"ADD_CLIENTE",payload:await m.crear(e)})},c=async(e,a)=>{let s=await m.actualizar(e,a);r({type:"UPDATE_CLIENTE",payload:{id:e,cliente:s}})},d=async e=>{await m.eliminar(e),r({type:"REMOVE_CLIENTE",payload:e})},v=async e=>{r({type:"ADD_SERVICIO",payload:await x.crear(e)})},N=async(e,a)=>{let s=await x.actualizar(e,a);r({type:"UPDATE_SERVICIO",payload:{id:e,servicio:s}})},F=async e=>{await x.eliminar(e),r({type:"REMOVE_SERVICIO",payload:e})},O=async(e,a)=>{r({type:"ADD_COTIZACION",payload:await p.crear(e,a)})},I=async(e,a)=>{let s=await p.actualizar(e,a);r({type:"UPDATE_COTIZACION",payload:{id:e,cotizacion:s}})},A=async e=>{r({type:"ADD_PROYECTO",payload:await p.aprobar(e)});let a=s.cotizaciones.find(a=>a.id===e);a&&r({type:"UPDATE_COTIZACION",payload:{id:e,cotizacion:{...a,estado:"aprobada",fechaAprobacion:new Date().toISOString().split("T")[0]}}})},k=async(e,a)=>{await p.rechazar(e,a);let t=s.cotizaciones.find(a=>a.id===e);t&&r({type:"UPDATE_COTIZACION",payload:{id:e,cotizacion:{...t,estado:"rechazada",fechaRechazo:new Date().toISOString().split("T")[0],motivoRechazo:a}}})},Z=async e=>{await p.eliminar(e),r({type:"REMOVE_COTIZACION",payload:e})},R=async(e,a)=>{let s=await h.actualizar(e,a);r({type:"UPDATE_PROYECTO",payload:{id:e,proyecto:s}})},V=async e=>{let a=await h.completar(e);r({type:"UPDATE_PROYECTO",payload:{id:e,proyecto:a}})},M=async e=>{r({type:"ADD_PLAN_PAGO",payload:await u.crear(e)})},L=async e=>{(await u.crearMultiples(e)).forEach(e=>{r({type:"ADD_PLAN_PAGO",payload:e})})},B=async(e,a)=>{let s=await u.actualizar(e,a);r({type:"UPDATE_PLAN_PAGO",payload:{id:e,plan:s}})},U=async e=>{r({type:"ADD_PAGO",payload:await b.crear(e)})},G=async e=>{await b.eliminar(e),r({type:"REMOVE_PAGO",payload:e})},q=async e=>{r({type:"ADD_CATEGORIA_DESEMBOLSO",payload:await g.crear(e)})},Y=async e=>{r({type:"ADD_DESEMBOLSO",payload:await j.crear(e)})},K=async(e,a)=>{let s=await j.actualizar(e,a);r({type:"UPDATE_DESEMBOLSO",payload:{id:e,desembolso:s}})},H=async e=>{await j.eliminar(e),r({type:"REMOVE_DESEMBOLSO",payload:e})},$=async(e,a,s)=>{await E(e,a,s),r({type:"SET_CONFIGURACION",payload:await y()})},Q=async e=>{await f.actualizarCompleta(e),r({type:"SET_CONFIGURACION",payload:await y()})},W=async(e,a)=>{await z(e,a),r({type:"SET_CONFIGURACION",payload:await y()})},X=async(e,a)=>{await S(e,a),r({type:"SET_METAS",payload:await w()})},J=async(e,a)=>{await D(e,a),r({type:"SET_ALERTAS",payload:await C()})},ee={...s,agregarCliente:n,actualizarCliente:c,eliminarCliente:d,agregarServicio:v,actualizarServicio:N,eliminarServicio:F,agregarCotizacion:O,actualizarCotizacion:I,aprobarCotizacion:A,rechazarCotizacion:k,eliminarCotizacion:Z,actualizarProyecto:R,completarProyecto:V,crearPlanPago:M,crearPlanesPago:L,actualizarPlanPago:B,registrarPago:U,eliminarPago:G,agregarCategoriaDesembolso:q,agregarDesembolso:Y,actualizarDesembolso:K,eliminarDesembolso:H,actualizarConfiguracion:$,actualizarConfiguracionCompleta:Q,eliminarConfiguracion:W,actualizarMeta:X,actualizarAlerta:J,cargarDatos:i,calcularMetricas:l};return(0,t.jsx)(T.Provider,{value:ee,children:a})}function O(){let e=(0,o.useContext)(T);if(void 0===e)throw Error("useServices debe usarse dentro de ServicesProvider");return e}var I=s(38361),A=s(89176),k=s(39889),Z=s(2553),R=s(80893),V=s(28562),M=s(55264),L=s(78497),B=s(4307);let U=()=>({formatearInput:(0,o.useCallback)(e=>{if(!e)return"";let a=e.toString().replace(/[^\d]/g,"");if(!a)return"";let s=parseInt(a);return new Intl.NumberFormat("es-CO").format(s)},[]),parsearInput:(0,o.useCallback)(e=>e?e.replace(/[^\d]/g,""):"",[]),manejarCambioNumerico:(0,o.useCallback)((e,a)=>{a(e.replace(/[^\d]/g,""))},[])}),G=[{value:"desarrollo",label:"Desarrollo",color:"blue"},{value:"dise\xf1o",label:"Dise\xf1o",color:"purple"},{value:"consultoria",label:"Consultor\xeda",color:"green"},{value:"soporte",label:"Soporte",color:"orange"},{value:"capacitacion",label:"Capacitaci\xf3n",color:"pink"},{value:"marketing",label:"Marketing",color:"red"},{value:"otros",label:"Otros",color:"gray"}],q=[{value:"unico",label:"\xdanico"},{value:"recurrente",label:"Recurrente"},{value:"por_horas",label:"Por horas"}],Y=[{value:"borrador",label:"Borrador",color:"gray"},{value:"enviada",label:"Enviada",color:"blue"},{value:"aprobada",label:"Aprobada",color:"green"},{value:"rechazada",label:"Rechazada",color:"red"},{value:"vencida",label:"Vencida",color:"orange"}],K=[{value:"activo",label:"Activo",color:"green"},{value:"pausado",label:"Pausado",color:"yellow"},{value:"completado",label:"Completado",color:"blue"},{value:"cancelado",label:"Cancelado",color:"red"}],H=[{value:"anticipo",label:"Anticipo"},{value:"cuota",label:"Cuota"},{value:"final",label:"Pago final"},{value:"hito",label:"Por hito"}],$=[{value:"efectivo",label:"Efectivo"},{value:"transferencia",label:"Transferencia"},{value:"cheque",label:"Cheque"},{value:"tarjeta",label:"Tarjeta"}],Q=[{value:"pendiente",label:"Pendiente",color:"gray"},{value:"pagado",label:"Pagado",color:"green"},{value:"aprobado",label:"Aprobado",color:"blue"}],W={nombre:"",categoria:"desarrollo",descripcion:"",costoBase:"",gastosFijos:"",margenDeseado:"35",precioSugerido:"",duracionEstimada:"1",tipoServicio:"unico",precioPorHora:"",recursosNecesarios:"",activo:!0},X={servicioId:"",descripcion:"",cantidad:"1",precioUnitario:"",descuentoPorcentaje:"0",notas:""},J={clienteId:"",fecha:new Date().toISOString().split("T")[0],fechaValidez:new Date(Date.now()+2592e6).toISOString().split("T")[0],estado:"borrador",descuentoPorcentaje:"0",notas:"",terminosCondiciones:"1. Validez de la cotizaci\xf3n: 30 d\xedas a partir de la fecha de emisi\xf3n.\n2. Forma de pago: 50% anticipo, 50% contra entrega.\n3. Los precios no incluyen IVA.\n4. Cualquier trabajo adicional ser\xe1 cotizado por separado.\n5. El tiempo de entrega est\xe1 sujeto a la aprobaci\xf3n de la cotizaci\xf3n.",items:[]},ee=[{nombre:"50% - 50%",descripcion:"Anticipo del 50% y pago final del 50%",planes:[{tipo:"anticipo",porcentaje:50,descripcion:"Anticipo del 50%"},{tipo:"final",porcentaje:50,descripcion:"Pago final del 50%"}]},{nombre:"40% - 40% - 20%",descripcion:"Anticipo, avance y pago final",planes:[{tipo:"anticipo",porcentaje:40,descripcion:"Anticipo del 40%"},{tipo:"cuota",porcentaje:40,descripcion:"Pago de avance del 40%"},{tipo:"final",porcentaje:20,descripcion:"Pago final del 20%"}]},{nombre:"Mensual",descripcion:"Pagos mensuales iguales",planes:[]},{nombre:"Por hitos",descripcion:"Pagos por cumplimiento de hitos",planes:[]}],ea=(e,a,s,t)=>Math.round((e+a)*(1+Object.values(t.porcentajes).reduce((e,a)=>e+(parseFloat(a.toString())||0),0)/100)*(1+s/100)),es=e=>{let a="string"==typeof e?parseInt(e)||0:e||0;return 0===a?"Inmediato":1===a?"1 d\xeda":a<7?"".concat(a," d\xedas"):7===a?"1 semana":a<30?"".concat(Math.ceil(a/7)," semanas"):30===a?"1 mes":a<365?"".concat(Math.ceil(a/30)," meses"):"".concat(Math.ceil(a/365)," a\xf1o").concat(a>=730?"s":"")};var et=s(46111),er=s(90437),el=s(39200),eo=s(14235),ei=s(23346),en=s(50039),ec=s(23488),ed=s(60493);let em=e=>{let a="string"==typeof e?parseFloat(e):e;return isNaN(a)?"0":new Intl.NumberFormat("es-CO").format(a)},ex=e=>{if(!e)return"";let a=e.toString().replace(/[^\d]/g,"");if(!a)return"";let s=parseInt(a);return new Intl.NumberFormat("es-CO").format(s)},ep=e=>{if(!e)return"";let a=e.toString().replace(/[^\d.]/g,"");if(!a)return"";let s=a.split(".");if(s.length>2)return s[0]+"."+s.slice(1).join("");let t=parseFloat(a);return isNaN(t)?"":new Intl.NumberFormat("es-CO",{minimumFractionDigits:0,maximumFractionDigits:2}).format(t)},eh=e=>{let a="string"==typeof e?parseFloat(e):e;return isNaN(a)?"$0":"$".concat(em(a))},eu=e=>{let{clientes:a,servicios:s,cotizaciones:r,proyectos:l,planesPago:o,pagos:i,desembolsos:n,metricas:c,configuracion:d,metas:m,alertas:x}=e;if(!c)return(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"})});let p=s.filter(e=>e.activo).length,h=l.filter(e=>"activo"===e.estado).length,u=r.filter(e=>"enviada"===e.estado).length,b=new Date().toISOString().split("T")[0];o.filter(e=>"pendiente"===e.estado&&e.fechaVencimiento<b).length;let g=l.filter(e=>"activo"===e.estado&&0>Math.ceil((new Date(e.fechaFinEstimada).getTime()-new Date().getTime())/864e5)).length,j=[...s].sort((e,a)=>(a.vecesCotizado||0)-(e.vecesCotizado||0)).slice(0,5),f=[...r].sort((e,a)=>new Date(a.fecha).getTime()-new Date(e.fecha).getTime()).slice(0,5),v=l.filter(e=>{if("activo"!==e.estado)return!1;let a=Math.ceil((new Date(e.fechaFinEstimada).getTime()-new Date().getTime())/864e5),s=o.filter(a=>a.proyectoId===e.id&&"pendiente"===a.estado&&a.fechaVencimiento<b).length;return a<=7||s>0}).slice(0,5),N=e=>new Date(e).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit"}),y=e=>{switch(e){case"borrador":default:return"bg-gray-100 text-gray-700";case"enviada":case"completado":return"bg-blue-100 text-blue-700";case"aprobada":case"activo":return"bg-emerald-100 text-emerald-700";case"rechazada":case"cancelado":return"bg-red-100 text-red-700";case"vencida":return"bg-orange-100 text-orange-700";case"pausado":return"bg-yellow-100 text-yellow-700"}};return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Ingresos del Mes"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-emerald-600",children:eh(c.ingresosMes)}),(0,t.jsxs)("p",{className:"text-sm text-slate-500",children:["Utilidad: ",(0,t.jsx)("span",{className:"font-medium text-emerald-600",children:eh(c.utilidadMes)})]})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-emerald-50 rounded-lg flex items-center justify-center",children:(0,t.jsx)(et.Z,{className:"w-6 h-6 text-emerald-600"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Cotizaciones Enviadas"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:c.cotizacionesEnviadas}),(0,t.jsxs)("p",{className:"text-sm text-slate-500",children:["Tasa conversi\xf3n: ",(0,t.jsxs)("span",{className:"font-medium",children:[c.tasaConversion.toFixed(1),"%"]})]})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center",children:(0,t.jsx)(Z.Z,{className:"w-6 h-6 text-blue-600"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Proyectos Activos"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-indigo-600",children:h}),(0,t.jsxs)("p",{className:"text-sm text-slate-500",children:["Total proyectos: ",(0,t.jsx)("span",{className:"font-medium",children:l.length})]})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-indigo-50 rounded-lg flex items-center justify-center",children:(0,t.jsx)(R.Z,{className:"w-6 h-6 text-indigo-600"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Flujo de Efectivo"}),(0,t.jsxs)("p",{className:"text-2xl font-bold ".concat(c.flujoEfectivo>=0?"text-emerald-600":"text-red-600"),children:[c.flujoEfectivo>=0?"+":"",eh(c.flujoEfectivo)]}),(0,t.jsxs)("p",{className:"text-sm text-slate-500",children:["Gastos: ",(0,t.jsx)("span",{className:"font-medium text-red-600",children:eh(c.gastosMes)})]})]}),(0,t.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center ".concat(c.flujoEfectivo>=0?"bg-emerald-50":"bg-red-50"),children:(0,t.jsx)(er.Z,{className:"w-6 h-6 ".concat(c.flujoEfectivo>=0?"text-emerald-600":"text-red-600")})})]})})]}),(c.pagosVencidos>0||g>0||u>0)&&(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,t.jsx)("div",{className:"p-3 bg-red-50 rounded-xl",children:(0,t.jsx)(el.Z,{className:"w-6 h-6 text-red-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Alertas y Acciones Requeridas"}),(0,t.jsx)("p",{className:"text-slate-600",children:"Elementos que requieren tu atenci\xf3n"})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",children:[c.pagosVencidos>0&&(0,t.jsxs)("div",{className:"border border-red-200 bg-red-50 rounded-xl p-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,t.jsx)(eo.Z,{className:"w-5 h-5 text-red-600"}),(0,t.jsx)("h3",{className:"font-semibold text-red-800",children:"Pagos Vencidos"})]}),(0,t.jsxs)("p",{className:"text-red-700",children:[c.pagosVencidos," pago",c.pagosVencidos>1?"s":""," vencido",c.pagosVencidos>1?"s":""]}),(0,t.jsx)("p",{className:"text-sm text-red-600 mt-1",children:"Requiere seguimiento inmediato"})]}),g>0&&(0,t.jsxs)("div",{className:"border border-orange-200 bg-orange-50 rounded-xl p-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,t.jsx)(ei.Z,{className:"w-5 h-5 text-orange-600"}),(0,t.jsx)("h3",{className:"font-semibold text-orange-800",children:"Proyectos Retrasados"})]}),(0,t.jsxs)("p",{className:"text-orange-700",children:[g," proyecto",g>1?"s":""," retrasado",g>1?"s":""]}),(0,t.jsx)("p",{className:"text-sm text-orange-600 mt-1",children:"Revisar cronograma"})]}),u>0&&(0,t.jsxs)("div",{className:"border border-blue-200 bg-blue-50 rounded-xl p-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,t.jsx)(en.Z,{className:"w-5 h-5 text-blue-600"}),(0,t.jsx)("h3",{className:"font-semibold text-blue-800",children:"Cotizaciones Pendientes"})]}),(0,t.jsxs)("p",{className:"text-blue-700",children:[u," cotizaci\xf3n",u>1?"es":""," pendiente",u>1?"s":""]}),(0,t.jsx)("p",{className:"text-sm text-blue-600 mt-1",children:"Esperando respuesta del cliente"})]})]})]}),(0,t.jsxs)("div",{className:"grid lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,t.jsx)("div",{className:"p-3 bg-purple-50 rounded-xl",children:(0,t.jsx)(ec.Z,{className:"w-6 h-6 text-purple-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Servicios M\xe1s Cotizados"}),(0,t.jsx)("p",{className:"text-slate-600",children:"Top 5 servicios por demanda"})]})]}),(0,t.jsx)("div",{className:"space-y-4",children:j.map((e,a)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:(0,t.jsxs)("span",{className:"text-purple-600 font-bold text-sm",children:["#",a+1]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-slate-800",children:e.nombre}),(0,t.jsx)("p",{className:"text-sm text-slate-600",children:eh(parseFloat(e.precioSugerido))})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"font-bold text-purple-600",children:e.vecesCotizado||0}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:"cotizaciones"})]})]},e.id))})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,t.jsx)("div",{className:"p-3 bg-indigo-50 rounded-xl",children:(0,t.jsx)(Z.Z,{className:"w-6 h-6 text-indigo-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"\xdaltimas Cotizaciones"}),(0,t.jsx)("p",{className:"text-slate-600",children:"Actividad reciente"})]})]}),(0,t.jsx)("div",{className:"space-y-4",children:f.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border border-slate-200 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,t.jsx)("p",{className:"font-medium text-slate-800",children:e.numero}),(0,t.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium ".concat(y(e.estado)),children:e.estado})]}),(0,t.jsx)("p",{className:"text-sm text-slate-600",children:e.clienteNombre})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"font-bold text-emerald-600",children:eh(e.total)}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:N(e.fecha)})]})]},e.id))})]})]}),v.length>0&&(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,t.jsx)("div",{className:"p-3 bg-orange-50 rounded-xl",children:(0,t.jsx)(R.Z,{className:"w-6 h-6 text-orange-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Proyectos que Requieren Atenci\xf3n"}),(0,t.jsx)("p",{className:"text-slate-600",children:"Proyectos con fechas pr\xf3ximas o pagos pendientes"})]})]}),(0,t.jsx)("div",{className:"space-y-4",children:v.map(e=>{let a=Math.ceil((new Date(e.fechaFinEstimada).getTime()-new Date().getTime())/864e5),s=o.filter(a=>a.proyectoId===e.id&&"pendiente"===a.estado&&a.fechaVencimiento<b).length;return(0,t.jsx)("div",{className:"border border-slate-200 rounded-lg p-4",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,t.jsx)("h3",{className:"font-semibold text-slate-800",children:e.nombre}),(0,t.jsx)("span",{className:"px-2 py-0.5 rounded-full text-xs font-medium ".concat(y(e.estado)),children:e.estado})]}),(0,t.jsx)("p",{className:"text-sm text-slate-600 mb-2",children:e.clienteNombre}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 text-sm",children:[a<=0&&(0,t.jsxs)("div",{className:"flex items-center space-x-1 text-red-600",children:[(0,t.jsx)(ei.Z,{className:"w-4 h-4"}),(0,t.jsxs)("span",{children:["Retrasado ",Math.abs(a)," d\xeda",Math.abs(a)>1?"s":""]})]}),a>0&&a<=7&&(0,t.jsxs)("div",{className:"flex items-center space-x-1 text-orange-600",children:[(0,t.jsx)(ei.Z,{className:"w-4 h-4"}),(0,t.jsxs)("span",{children:[a," d\xeda",a>1?"s":""," restante",a>1?"s":""]})]}),s>0&&(0,t.jsxs)("div",{className:"flex items-center space-x-1 text-red-600",children:[(0,t.jsx)(eo.Z,{className:"w-4 h-4"}),(0,t.jsxs)("span",{children:[s," pago",s>1?"s":""," vencido",s>1?"s":""]})]})]})]}),(0,t.jsxs)("div",{className:"text-right ml-4",children:[(0,t.jsx)("p",{className:"font-bold text-emerald-600",children:eh(e.valorTotal)}),(0,t.jsx)("div",{className:"w-20 bg-slate-200 rounded-full h-2 mt-1",children:(0,t.jsx)("div",{className:"bg-emerald-500 h-2 rounded-full",style:{width:"".concat(e.progreso,"%")}})}),(0,t.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:[e.progreso,"% completado"]})]})]})},e.id)})})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-4 gap-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-xl p-6 border border-slate-200 text-center",children:[(0,t.jsx)(A.Z,{className:"w-8 h-8 text-purple-600 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-slate-800",children:a.length}),(0,t.jsx)("p",{className:"text-sm text-slate-600",children:"Clientes Registrados"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl p-6 border border-slate-200 text-center",children:[(0,t.jsx)(Z.Z,{className:"w-8 h-8 text-blue-600 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-slate-800",children:p}),(0,t.jsx)("p",{className:"text-sm text-slate-600",children:"Servicios Activos"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl p-6 border border-slate-200 text-center",children:[(0,t.jsx)(ed.Z,{className:"w-8 h-8 text-emerald-600 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-slate-800",children:c.cotizacionesAprobadas}),(0,t.jsx)("p",{className:"text-sm text-slate-600",children:"Cotizaciones Aprobadas"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl p-6 border border-slate-200 text-center",children:[(0,t.jsx)(R.Z,{className:"w-8 h-8 text-indigo-600 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-slate-800",children:l.filter(e=>"completado"===e.estado).length}),(0,t.jsx)("p",{className:"text-sm text-slate-600",children:"Proyectos Completados"})]})]})]})};var eb=s(28887),eg=s(69819),ej=s(62190),ef=s(4270),ev=s(31855),eN=s(37864);let ey=e=>{let{servicios:a,servicioActual:s,editandoId:r,onCambioInput:l,onCalcularPrecios:i,onAgregarServicio:n,onEditarServicio:c,onGuardarEdicion:d,onEliminarServicio:m,onCancelarEdicion:x,configuracion:p}=e,h=e=>{if(null==e||""===e)return"0";let a="string"==typeof e?parseFloat(e.replace(/[^\d.-]/g,"")):e;return isNaN(a)?"0":new Intl.NumberFormat("es-CO").format(a)},u=e=>null==e||0===e||"0"===e?"No definido":"$".concat(h(e)),b=e=>{if("por_horas"!==e.tipoServicio)return u(e.precioSugerido);{let a=u(e.precioPorHora);return"No definido"===a?"No definido":"".concat(a,"/hora")}},g=e=>{let a=G.find(a=>a.value===e);return(null==a?void 0:a.color)||"gray"},j=e=>{switch(e){case"recurrente":return"\uD83D\uDD04";case"por_horas":return"⏱️";default:return"\uD83D\uDCCB"}};return o.useEffect(()=>{if(s.costoBase||s.margenDeseado){let e=ea(parseFloat(s.costoBase)||0,parseFloat(s.gastosFijos)||0,parseFloat(s.margenDeseado)||35,p);e!==parseFloat(s.precioSugerido)&&l("precioSugerido",e.toString())}},[s.costoBase,s.gastosFijos,s.margenDeseado,p]),(0,t.jsxs)("div",{className:"grid lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,t.jsx)("div",{className:"p-3 bg-blue-50 rounded-xl",children:(0,t.jsx)(eb.Z,{className:"w-6 h-6 text-blue-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:r?"Editar Servicio":"Nuevo Servicio"}),(0,t.jsx)("p",{className:"text-slate-600",children:"Configura servicios con precios autom\xe1ticos"})]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Nombre del Servicio"}),(0,t.jsx)("input",{type:"text",value:s.nombre,onChange:e=>l("nombre",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Ej: Desarrollo Web B\xe1sico"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Categor\xeda"}),(0,t.jsx)("select",{value:s.categoria,onChange:e=>l("categoria",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:G.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Descripci\xf3n"}),(0,t.jsx)("textarea",{value:s.descripcion,onChange:e=>l("descripcion",e.target.value),rows:3,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none",placeholder:"Describe brevemente el servicio y qu\xe9 incluye..."})]}),(0,t.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-4",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-purple-800 mb-3",children:"Configuraci\xf3n del Servicio"}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-purple-700 mb-2",children:"Tipo de Servicio"}),(0,t.jsx)("select",{value:s.tipoServicio,onChange:e=>l("tipoServicio",e.target.value),className:"w-full px-3 py-2 border border-purple-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-white",children:q.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-purple-700 mb-2",children:"por_horas"===s.tipoServicio?"Precio por Hora":"Duraci\xf3n (d\xedas)"}),"por_horas"===s.tipoServicio?(0,t.jsx)("input",{type:"text",value:ex(s.precioPorHora),onChange:e=>l("precioPorHora",e.target.value),className:"w-full px-3 py-2 border border-purple-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-white",placeholder:"120000"}):(0,t.jsx)("input",{type:"text",value:s.duracionEstimada,onChange:e=>l("duracionEstimada",e.target.value),className:"w-full px-3 py-2 border border-purple-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-white",placeholder:"15"}),(0,t.jsx)("p",{className:"text-xs text-purple-600 mt-1",children:"por_horas"===s.tipoServicio?"Tarifa por hora de trabajo":"Duraci\xf3n estimada: ".concat(es(parseInt(s.duracionEstimada)||0))})]})]}),"por_horas"!==s.tipoServicio&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-purple-700 mb-2",children:"Recursos Necesarios"}),(0,t.jsx)("textarea",{value:s.recursosNecesarios,onChange:e=>l("recursosNecesarios",e.target.value),rows:2,className:"w-full px-3 py-2 border border-purple-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-white resize-none",placeholder:"Ej: 1 Desarrollador senior, 1 Dise\xf1ador, Hosting, Dominio..."})]})]}),"por_horas"!==s.tipoServicio&&(0,t.jsxs)("div",{className:"bg-emerald-50 border border-emerald-200 rounded-xl p-4",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold text-emerald-800 mb-3",children:"C\xe1lculo de Precios"}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-emerald-700 mb-2",children:"Costo Base"}),(0,t.jsx)("input",{type:"text",value:ex(s.costoBase),onChange:e=>l("costoBase",e.target.value),className:"w-full px-3 py-2 border border-emerald-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent bg-white",placeholder:"800000"}),(0,t.jsx)("p",{className:"text-xs text-emerald-600 mt-1",children:"Costo directo del servicio"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-emerald-700 mb-2",children:"Gastos Fijos Asignados"}),(0,t.jsx)("input",{type:"text",value:ex(s.gastosFijos),onChange:e=>l("gastosFijos",e.target.value),className:"w-full px-3 py-2 border border-emerald-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent bg-white",placeholder:"150000"}),(0,t.jsx)("p",{className:"text-xs text-emerald-600 mt-1",children:"Proporci\xf3n de gastos fijos"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-emerald-700 mb-2",children:"Margen Deseado (%)"}),(0,t.jsx)("input",{type:"text",value:s.margenDeseado,onChange:e=>l("margenDeseado",e.target.value),className:"w-full px-3 py-2 border border-emerald-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent bg-white",placeholder:"35"}),(0,t.jsx)("p",{className:"text-xs text-emerald-600 mt-1",children:"Margen de ganancia deseado"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-emerald-700 mb-2",children:"Precio Sugerido"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"text",value:ex(s.precioSugerido),onChange:e=>l("precioSugerido",e.target.value),className:"w-full px-3 py-2 pr-8 border border-emerald-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent bg-emerald-100 font-semibold text-emerald-800",readOnly:!0}),(0,t.jsx)(et.Z,{className:"absolute right-2 top-2.5 w-4 h-4 text-emerald-600"})]}),(0,t.jsx)("p",{className:"text-xs text-emerald-600 mt-1",children:"Calculado autom\xe1ticamente"})]})]})]}),(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("input",{type:"checkbox",id:"servicioActivo",checked:s.activo,onChange:e=>l("activo",e.target.checked.toString()),className:"w-5 h-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,t.jsx)("label",{htmlFor:"servicioActivo",className:"text-sm font-medium text-slate-700",children:"Servicio activo y disponible para cotizar"})]})}),(0,t.jsx)("div",{className:"flex space-x-3 pt-4 border-t border-slate-200",children:r?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:d,className:"flex-1 bg-emerald-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-emerald-600 transition-colors flex items-center justify-center space-x-2",children:[(0,t.jsx)(eg.Z,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:"Guardar Cambios"})]}),(0,t.jsxs)("button",{onClick:x,className:"px-6 py-3 border border-slate-300 text-slate-700 rounded-xl font-semibold hover:bg-slate-50 transition-colors flex items-center space-x-2",children:[(0,t.jsx)(ej.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Cancelar"})]})]}):(0,t.jsxs)("button",{onClick:n,disabled:!s.nombre||!s.costoBase&&"por_horas"!==s.tipoServicio,className:"flex-1 bg-blue-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-blue-600 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center space-x-2",children:[(0,t.jsx)(ef.Z,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:"Agregar Servicio"})]})})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"p-3 bg-indigo-50 rounded-xl",children:(0,t.jsx)(er.Z,{className:"w-6 h-6 text-indigo-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Cat\xe1logo de Servicios"}),(0,t.jsxs)("p",{className:"text-slate-600",children:[a.length," servicios registrados"]})]})]})}),0===a.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(eb.Z,{className:"w-8 h-8 text-slate-400"})}),(0,t.jsx)("p",{className:"text-slate-600 mb-2",children:"No hay servicios registrados"}),(0,t.jsx)("p",{className:"text-slate-500 text-sm",children:"Agrega tu primer servicio para comenzar"})]}):(0,t.jsx)("div",{className:"space-y-4 max-h-[600px] overflow-y-auto",children:a.map(e=>{var a;return(0,t.jsx)("div",{className:"border rounded-xl p-4 transition-all hover:shadow-md ".concat(r===e.id?"border-blue-300 bg-blue-50":"border-slate-200 hover:border-slate-300"),children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,t.jsx)("span",{className:"text-lg",children:j(e.tipoServicio)}),(0,t.jsx)("h3",{className:"font-semibold text-slate-800",children:e.nombre}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-".concat(g(e.categoria),"-100 text-").concat(g(e.categoria),"-700"),children:null===(a=G.find(a=>a.value===e.categoria))||void 0===a?void 0:a.label}),!e.activo&&(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700",children:"Inactivo"})]}),e.descripcion&&(0,t.jsx)("p",{className:"text-slate-600 text-sm mb-3 line-clamp-2",children:e.descripcion}),(0,t.jsxs)("div",{className:"flex items-center space-x-6 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(et.Z,{className:"w-4 h-4 ".concat("No definido"===b(e)?"text-slate-400":"text-emerald-600")}),(0,t.jsx)("span",{className:"font-semibold ".concat("No definido"===b(e)?"text-slate-500":"text-emerald-700"),children:b(e)})]}),"por_horas"!==e.tipoServicio&&(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(en.Z,{className:"w-4 h-4 text-blue-600"}),(0,t.jsx)("span",{className:"text-slate-600",children:es(e.duracionEstimada)})]}),(0,t.jsxs)("div",{className:"text-slate-500",children:[e.vecesCotizado," cotizado",1!==e.vecesCotizado?"s":""," • ",e.vecesVendido," vendido",1!==e.vecesVendido?"s":""]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,t.jsx)("button",{onClick:()=>c(e.id),className:"p-2 text-slate-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Editar servicio",children:(0,t.jsx)(ev.Z,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>m(e.id),className:"p-2 text-slate-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar servicio",children:(0,t.jsx)(eN.Z,{className:"w-4 h-4"})})]})]})},e.id)})})]})]})};var ew=s(185),eC=s(86691),eE=s(21700),ez=s(3350);let eS={nombre:"",empresa:"",nit:"",email:"",telefono:"",direccion:"",ciudad:"",notas:""},eD=e=>{let{clientes:a,onAgregarCliente:s,onActualizarCliente:r,onEliminarCliente:l}=e,[i,n]=(0,o.useState)(eS),[c,d]=(0,o.useState)(null),[m,x]=(0,o.useState)(""),p=()=>{n(eS),d(null)},h=(e,a)=>{n(s=>({...s,[e]:a}))},u=async()=>{if(i.nombre)try{c?await r(c,i):await s(i),p()}catch(e){console.error("Error al guardar cliente:",e),alert("Error al guardar el cliente")}},b=e=>{n({nombre:e.nombre,empresa:e.empresa||"",nit:e.nit||"",email:e.email||"",telefono:e.telefono||"",direccion:e.direccion||"",ciudad:e.ciudad||"",notas:e.notas||""}),d(e.id)},g=async e=>{if(confirm("\xbfEst\xe1s seguro de eliminar este cliente?"))try{await l(e)}catch(e){console.error("Error al eliminar cliente:",e),alert("Error al eliminar el cliente")}},j=a.filter(e=>{var a,s;return e.nombre.toLowerCase().includes(m.toLowerCase())||(null===(a=e.empresa)||void 0===a?void 0:a.toLowerCase().includes(m.toLowerCase()))||(null===(s=e.email)||void 0===s?void 0:s.toLowerCase().includes(m.toLowerCase()))});return(0,t.jsxs)("div",{className:"grid lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,t.jsx)("div",{className:"p-3 bg-purple-50 rounded-xl",children:(0,t.jsx)(A.Z,{className:"w-6 h-6 text-purple-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:c?"Editar Cliente":"Nuevo Cliente"}),(0,t.jsx)("p",{className:"text-slate-600",children:"Gestiona tu base de datos de clientes"})]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Nombre Completo *"}),(0,t.jsx)("input",{type:"text",value:i.nombre,onChange:e=>h("nombre",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:"Juan P\xe9rez"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Empresa"}),(0,t.jsx)("input",{type:"text",value:i.empresa,onChange:e=>h("empresa",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:"Empresa S.A.S."})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"NIT/C\xe9dula"}),(0,t.jsx)("input",{type:"text",value:i.nit,onChange:e=>h("nit",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:"900123456-1"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Email"}),(0,t.jsx)("input",{type:"email",value:i.email,onChange:e=>h("email",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:"cliente@empresa.com"})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Tel\xe9fono"}),(0,t.jsx)("input",{type:"tel",value:i.telefono,onChange:e=>h("telefono",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:"+57 300 123 4567"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Ciudad"}),(0,t.jsx)("input",{type:"text",value:i.ciudad,onChange:e=>h("ciudad",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:"Bogot\xe1"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Direcci\xf3n"}),(0,t.jsx)("input",{type:"text",value:i.direccion,onChange:e=>h("direccion",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all",placeholder:"Cra. 7 # 71-21, Torre A, Oficina 401"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Notas"}),(0,t.jsx)("textarea",{value:i.notas,onChange:e=>h("notas",e.target.value),rows:3,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all resize-none",placeholder:"Informaci\xf3n adicional sobre el cliente..."})]}),(0,t.jsx)("div",{className:"flex space-x-3 pt-4 border-t border-slate-200",children:c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:u,className:"flex-1 bg-emerald-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-emerald-600 transition-colors flex items-center justify-center space-x-2",children:[(0,t.jsx)(eg.Z,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:"Guardar Cambios"})]}),(0,t.jsxs)("button",{onClick:p,className:"px-6 py-3 border border-slate-300 text-slate-700 rounded-xl font-semibold hover:bg-slate-50 transition-colors flex items-center space-x-2",children:[(0,t.jsx)(ej.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Cancelar"})]})]}):(0,t.jsxs)("button",{onClick:u,disabled:!i.nombre,className:"flex-1 bg-purple-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-purple-600 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center space-x-2",children:[(0,t.jsx)(ef.Z,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:"Agregar Cliente"})]})})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"p-3 bg-indigo-50 rounded-xl",children:(0,t.jsx)(A.Z,{className:"w-6 h-6 text-indigo-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Base de Clientes"}),(0,t.jsxs)("p",{className:"text-slate-600",children:[a.length," clientes registrados"]})]})]})}),(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsx)("input",{type:"text",value:m,onChange:e=>x(e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",placeholder:"Buscar por nombre, empresa o email..."})}),0===j.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(A.Z,{className:"w-8 h-8 text-slate-400"})}),(0,t.jsx)("p",{className:"text-slate-600 mb-2",children:m?"No se encontraron clientes":"No hay clientes registrados"}),(0,t.jsx)("p",{className:"text-slate-500 text-sm",children:m?"Intenta con otros t\xe9rminos de b\xfasqueda":"Agrega tu primer cliente para comenzar"})]}):(0,t.jsx)("div",{className:"space-y-4 max-h-[600px] overflow-y-auto",children:j.map(e=>(0,t.jsx)("div",{className:"border rounded-xl p-4 transition-all hover:shadow-md ".concat(c===e.id?"border-purple-300 bg-purple-50":"border-slate-200 hover:border-slate-300"),children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-white font-semibold text-sm",children:e.nombre.split(" ").map(e=>e[0]).join("").slice(0,2).toUpperCase()})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-slate-800",children:e.nombre}),e.empresa&&(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(ew.Z,{className:"w-3 h-3 text-slate-500"}),(0,t.jsx)("span",{className:"text-slate-600 text-sm",children:e.empresa})]})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-3 text-sm",children:[e.email&&(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(eC.Z,{className:"w-4 h-4 text-slate-500"}),(0,t.jsx)("span",{className:"text-slate-600",children:e.email})]}),e.telefono&&(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(eE.Z,{className:"w-4 h-4 text-slate-500"}),(0,t.jsx)("span",{className:"text-slate-600",children:e.telefono})]}),e.ciudad&&(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(ez.Z,{className:"w-4 h-4 text-slate-500"}),(0,t.jsx)("span",{className:"text-slate-600",children:e.ciudad})]}),e.nit&&(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(Z.Z,{className:"w-4 h-4 text-slate-500"}),(0,t.jsx)("span",{className:"text-slate-600",children:e.nit})]})]}),e.notas&&(0,t.jsx)("div",{className:"mt-3 p-3 bg-slate-50 rounded-lg",children:(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:e.notas})})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,t.jsx)("button",{onClick:()=>b(e),className:"p-2 text-slate-500 hover:text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",title:"Editar cliente",children:(0,t.jsx)(ev.Z,{className:"w-4 h-4"})}),(0,t.jsx)("button",{onClick:()=>g(e.id),className:"p-2 text-slate-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar cliente",children:(0,t.jsx)(eN.Z,{className:"w-4 h-4"})})]})]})},e.id))})]})]})};var eP=s(78865),e_=s(36127),eT=s(47935),eF=s(15928),eO=s(8267);let eI=e=>{let{clientes:a,servicios:s,onCrear:r,onCancelar:l}=e,[i,n]=(0,o.useState)(J),[c,d]=(0,o.useState)(!1);console.log("CrearCotizacion - Servicios recibidos:",s),console.log("CrearCotizacion - Servicios activos:",s.filter(e=>e.activo));let m=(e,a)=>{n(s=>({...s,[e]:a}))},x=(e,a,s)=>{let t=[...i.items];if(t[e]={...t[e],[a]:s},"cantidad"===a||"precioUnitario"===a||"descuentoPorcentaje"===a){let a=t[e];parseFloat(a.cantidad),parseFloat(a.precioUnitario),parseFloat(a.descuentoPorcentaje)}n(e=>({...e,items:t}))},p=e=>{n(a=>({...a,items:a.items.filter((a,s)=>s!==e)}))},h=(e,a)=>{console.log("Seleccionando servicio:",{index:e,servicioId:a});let t=s.find(e=>e.id===a);if(console.log("Servicio encontrado:",t),t){let s=[...i.items];s[e]={...s[e],servicioId:a,descripcion:t.descripcion||t.nombre,precioUnitario:t.precioSugerido},console.log("Actualizando item:",s[e]),n(e=>({...e,items:s}))}},{subtotal:u,descuentoValor:b,subtotalConDescuento:g,iva:j,total:f}=(()=>{let e=0;i.items.forEach(a=>{let s=parseFloat(a.cantidad)||0,t=parseFloat(a.precioUnitario)||0,r=parseFloat(a.descuentoPorcentaje)||0,l=s*t;e+=l-r/100*l});let a=(parseFloat(i.descuentoPorcentaje)||0)/100*e,s=e-a,t=.19*s;return{subtotal:e,descuentoValor:a,subtotalConDescuento:s,iva:t,total:s+t}})(),v=async()=>{if(!i.clienteId||0===i.items.length){alert("Debe seleccionar un cliente y agregar al menos un servicio");return}let e=[];if(i.items.forEach((a,s)=>{let t=!!a.servicioId,r=!!a.cantidad&&parseFloat(a.cantidad)>0,l=!!a.precioUnitario&&parseFloat(a.precioUnitario)>0;t||e.push("Item ".concat(s+1,": Debe seleccionar un servicio")),r||e.push("Item ".concat(s+1,": La cantidad debe ser mayor a 0")),l||e.push("Item ".concat(s+1,": El precio debe ser mayor a 0"))}),e.length>0){alert("Por favor corrige los siguientes errores:\n\n"+e.join("\n"));return}d(!0);try{let e={clienteId:i.clienteId,fecha:i.fecha,fechaValidez:i.fechaValidez,estado:i.estado,subtotal:u,descuentoPorcentaje:parseFloat(i.descuentoPorcentaje)||0,descuentoValor:b,iva:j,total:f,notas:i.notas,terminosCondiciones:i.terminosCondiciones},a=i.items.map(e=>{let a=parseFloat(e.cantidad)||0,s=parseFloat(e.precioUnitario)||0,t=parseFloat(e.descuentoPorcentaje)||0,r=a*s;return{servicioId:e.servicioId,descripcion:e.descripcion,cantidad:a,precioUnitario:s,descuentoPorcentaje:t,subtotal:r-t/100*r,notas:e.notas}});await r(e,a),alert("Cotizaci\xf3n creada exitosamente"),l()}catch(e){console.error("Error al crear cotizaci\xf3n:",e),alert("Error al crear la cotizaci\xf3n")}finally{d(!1)}},N=a.find(e=>e.id===i.clienteId);return(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"p-3 bg-indigo-50 rounded-xl",children:(0,t.jsx)(Z.Z,{className:"w-6 h-6 text-indigo-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:"Nueva Cotizaci\xf3n"}),(0,t.jsx)("p",{className:"text-slate-600",children:"Crea una cotizaci\xf3n profesional para tu cliente"})]})]}),(0,t.jsx)("button",{onClick:l,className:"p-2 text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded-lg transition-colors",children:(0,t.jsx)(ej.Z,{className:"w-6 h-6"})})]}),(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Cliente *"}),(0,t.jsxs)("select",{value:i.clienteId,onChange:e=>m("clienteId",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",children:[(0,t.jsx)("option",{value:"",children:"Seleccionar cliente..."}),a.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.nombre," ",e.empresa&&"- ".concat(e.empresa)]},e.id))]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Fecha"}),(0,t.jsx)("input",{type:"date",value:i.fecha,onChange:e=>m("fecha",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"V\xe1lida hasta"}),(0,t.jsx)("input",{type:"date",value:i.fechaValidez,onChange:e=>m("fechaValidez",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"})]})]})]}),N&&(0,t.jsxs)("div",{className:"bg-slate-50 rounded-xl p-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,t.jsx)(eO.Z,{className:"w-5 h-5 text-slate-600"}),(0,t.jsx)("h3",{className:"font-semibold text-slate-800",children:"Informaci\xf3n del Cliente"})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-slate-500",children:"Nombre:"}),(0,t.jsx)("span",{className:"ml-2 font-medium",children:N.nombre})]}),N.empresa&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-slate-500",children:"Empresa:"}),(0,t.jsx)("span",{className:"ml-2 font-medium",children:N.empresa})]}),N.email&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-slate-500",children:"Email:"}),(0,t.jsx)("span",{className:"ml-2",children:N.email})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-slate-800",children:"Servicios"}),(0,t.jsxs)("button",{onClick:()=>{let e={...X};n(a=>({...a,items:[...a.items,e]}))},className:"bg-indigo-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-indigo-600 transition-colors flex items-center space-x-2",children:[(0,t.jsx)(ef.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Agregar Servicio"})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[i.items.map((e,a)=>(console.log("Renderizando item ".concat(a,":"),e),(0,t.jsx)("div",{className:"border border-slate-200 rounded-xl p-4",children:(0,t.jsxs)("div",{className:"grid gap-4",children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Servicio"}),(0,t.jsxs)("select",{value:e.servicioId,onChange:e=>{console.log("Select onChange - value:",e.target.value),h(a,e.target.value)},className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",children:[(0,t.jsx)("option",{value:"",children:"Seleccionar servicio..."}),s.filter(e=>e.activo).map(e=>(console.log("Renderizando opci\xf3n:",{id:e.id,nombre:e.nombre,precio:e.precioSugerido}),(0,t.jsxs)("option",{value:e.id,children:[e.nombre," - $",eh(parseFloat(e.precioSugerido))]},e.id)))]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Cantidad"}),(0,t.jsx)("input",{type:"text",value:e.cantidad,onChange:e=>x(a,"cantidad",e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",placeholder:"1"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Precio Unit."}),(0,t.jsx)("input",{type:"text",value:ep(e.precioUnitario),onChange:e=>x(a,"precioUnitario",e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",placeholder:"0"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Desc. %"}),(0,t.jsx)("input",{type:"text",value:e.descuentoPorcentaje,onChange:e=>x(a,"descuentoPorcentaje",e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",placeholder:"0"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Descripci\xf3n"}),(0,t.jsx)("textarea",{value:e.descripcion,onChange:e=>x(a,"descripcion",e.target.value),rows:2,className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all resize-none",placeholder:"Descripci\xf3n detallada del servicio..."})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"text-sm text-slate-600",children:["Subtotal: ",(0,t.jsxs)("span",{className:"font-semibold text-emerald-600",children:["$",eh((parseFloat(e.cantidad)||0)*(parseFloat(e.precioUnitario)||0)*(1-(parseFloat(e.descuentoPorcentaje)||0)/100))]})]}),(0,t.jsx)("button",{onClick:()=>p(a),className:"p-2 text-slate-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar item",children:(0,t.jsx)(eN.Z,{className:"w-4 h-4"})})]})]})},a))),0===i.items.length&&(0,t.jsxs)("div",{className:"text-center py-8 border-2 border-dashed border-slate-300 rounded-xl",children:[(0,t.jsx)(eb.Z,{className:"w-12 h-12 text-slate-400 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-slate-600 mb-2",children:"No hay servicios agregados"}),(0,t.jsx)("p",{className:"text-slate-500 text-sm",children:"Agrega servicios para crear la cotizaci\xf3n"})]})]})]}),i.items.length>0&&(0,t.jsx)("div",{className:"border-t border-slate-200 pt-6",children:(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Descuento General (%)"}),(0,t.jsx)("input",{type:"text",value:i.descuentoPorcentaje,onChange:e=>m("descuentoPorcentaje",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",placeholder:"0"})]}),(0,t.jsxs)("div",{className:"bg-slate-50 rounded-xl p-6",children:[(0,t.jsx)("h4",{className:"font-semibold text-slate-800 mb-4",children:"Resumen"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"Subtotal:"}),(0,t.jsxs)("span",{className:"font-medium",children:["$",eh(u)]})]}),b>0&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"Descuento:"}),(0,t.jsxs)("span",{className:"text-red-600",children:["-$",eh(b)]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{className:"text-slate-600",children:["IVA (",19,"%):"]}),(0,t.jsxs)("span",{className:"font-medium",children:["$",eh(j)]})]}),(0,t.jsxs)("div",{className:"border-t border-slate-300 pt-2 flex justify-between",children:[(0,t.jsx)("span",{className:"font-bold text-slate-800",children:"Total:"}),(0,t.jsxs)("span",{className:"font-bold text-emerald-600 text-lg",children:["$",eh(f)]})]})]})]})]})}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Notas"}),(0,t.jsx)("textarea",{value:i.notas,onChange:e=>m("notas",e.target.value),rows:3,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all resize-none",placeholder:"Notas adicionales sobre la cotizaci\xf3n..."})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"T\xe9rminos y Condiciones"}),(0,t.jsx)("textarea",{value:i.terminosCondiciones,onChange:e=>m("terminosCondiciones",e.target.value),rows:6,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all resize-none",placeholder:"T\xe9rminos y condiciones..."})]})]}),(0,t.jsxs)("div",{className:"flex space-x-4 pt-6 border-t border-slate-200",children:[(0,t.jsxs)("button",{onClick:v,disabled:c||!i.clienteId||0===i.items.length,className:"flex-1 bg-indigo-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-indigo-600 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center space-x-2",children:[(0,t.jsx)(eg.Z,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:c?"Guardando...":"Crear Cotizaci\xf3n"})]}),(0,t.jsx)("button",{onClick:l,className:"px-6 py-3 border border-slate-300 text-slate-700 rounded-xl font-semibold hover:bg-slate-50 transition-colors",children:"Cancelar"})]})]})]})};var eA=s(92761),ek=s(12779),eZ=s(91819),eR=s(45114);let eV=e=>{var a;let{cotizacion:s,clientes:r,servicios:l,configuracion:i,onVolver:n,onAprobar:c,onRechazar:d,onActualizar:m}=e,[x,p]=(0,o.useState)(!1),[h,u]=(0,o.useState)(""),b=r.find(e=>e.id===s.clienteId),g=e=>{let a=Y.find(a=>a.value===e);return(null==a?void 0:a.color)||"gray"},j=e=>new Date(e).toLocaleDateString("es-CO",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),f=async()=>{confirm("\xbfConfirmas la aprobaci\xf3n de esta cotizaci\xf3n? Se crear\xe1 autom\xe1ticamente un proyecto.")&&await c(s.id)},v=async()=>{if(!h.trim()){alert("Debe proporcionar un motivo del rechazo");return}await d(s.id,h),p(!1),u("")},N=(e=>{let a=new Date;return Math.ceil((new Date(e).getTime()-a.getTime())/864e5)})(s.fechaValidez),y=N<0&&"enviada"===s.estado;return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("button",{onClick:n,className:"p-2 text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded-lg transition-colors",children:(0,t.jsx)(eA.Z,{className:"w-6 h-6"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-slate-800",children:s.numero}),(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-".concat(g(s.estado),"-100 text-").concat(g(s.estado),"-700"),children:(e=>{let a=Y.find(a=>a.value===e);return(null==a?void 0:a.label)||e})(s.estado)}),y&&(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-red-100 text-red-700",children:"Vencida"})]}),(0,t.jsxs)("p",{className:"text-slate-600",children:["Valor total: ",(0,t.jsx)("span",{className:"font-bold text-emerald-600 text-xl",children:eh(s.total)})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("button",{onClick:()=>{var e,a,t,r,o,n,c,d,m,x,p;let h=new eZ.ZP;h.setFont("helvetica"),h.setFontSize(20),h.setTextColor(51,51,51),h.text("COTIZACI\xd3N",20,25),h.setFontSize(14),h.setTextColor(59,130,246),h.text(s.numero,20,35),h.setFontSize(10),h.setTextColor(100,100,100),h.text((null===(e=i.empresa)||void 0===e?void 0:e.nombre)||"Mi Empresa SAS",140,25),h.text("NIT: ".concat((null===(a=i.empresa)||void 0===a?void 0:a.nit)||"123456789-0"),140,30),h.text((null===(t=i.empresa)||void 0===t?void 0:t.email)||"contacto@miempresa.com",140,35),h.text((null===(r=i.empresa)||void 0===r?void 0:r.telefono)||"+57 300 123 4567",140,40),(null===(o=i.empresa)||void 0===o?void 0:o.direccion)&&h.text(i.empresa.direccion,140,45),(null===(n=i.empresa)||void 0===n?void 0:n.ciudad)&&h.text(i.empresa.ciudad,140,50),h.setFontSize(12),h.setTextColor(51,51,51),h.text("INFORMACI\xd3N DEL CLIENTE",20,55);let u=65;h.setFontSize(10),b&&(h.text("Nombre: ".concat(b.nombre),20,u),u+=5,b.empresa&&(h.text("Empresa: ".concat(b.empresa),20,u),u+=5),b.nit&&(h.text("NIT/C\xe9dula: ".concat(b.nit),20,u),u+=5),b.email&&(h.text("Email: ".concat(b.email),20,u),u+=5),b.telefono&&(h.text("Tel\xe9fono: ".concat(b.telefono),20,u),u+=5)),u+=10,h.setFontSize(12),h.text("FECHAS",20,u),u+=10,h.setFontSize(10),h.text("Fecha de emisi\xf3n: ".concat(j(s.fecha)),20,u),u+=5,h.text("V\xe1lida hasta: ".concat(j(s.fechaValidez)),20,u),u+=15;let g=(null===(c=s.items)||void 0===c?void 0:c.map(e=>{let a=l.find(a=>a.id===e.servicio_id);return[(null==a?void 0:a.nombre)||"Servicio",e.cantidad.toString(),eh(e.precio_unitario),e.descuento_porcentaje?"".concat(e.descuento_porcentaje,"%"):"0%",eh(e.subtotal)]}))||[];(0,eR.ZP)(h,{head:[["Servicio","Cant.","Precio Unit.","Desc.","Subtotal"]],body:g,startY:u,styles:{fontSize:9,cellPadding:3},headStyles:{fillColor:[59,130,246],textColor:[255,255,255],fontStyle:"bold"},columnStyles:{0:{cellWidth:60},1:{cellWidth:20,halign:"center"},2:{cellWidth:30,halign:"right"},3:{cellWidth:20,halign:"center"},4:{cellWidth:30,halign:"right"}}});let f=(null===(d=h.lastAutoTable)||void 0===d?void 0:d.finalY)||u+10*g.length+20;h.setFontSize(10),h.text("Subtotal: ".concat(eh(s.subtotal)),140,f),s.descuentoValor>0&&h.text("Descuento (".concat(s.descuentoPorcentaje,"%): -").concat(eh(s.descuentoValor)),140,f+5),h.text("IVA: ".concat(eh(s.iva)),140,f+(s.descuentoValor>0?10:5)),h.setFontSize(12),h.setFont("helvetica","bold"),h.text("TOTAL: ".concat(eh(s.total)),140,f+(s.descuentoValor>0?18:13));let v=s.terminosCondiciones||(null===(m=i.cotizaciones)||void 0===m?void 0:m.terminosCondiciones)||"";if(v){let e=f+30;h.setFontSize(12),h.setFont("helvetica","bold"),h.text("T\xc9RMINOS Y CONDICIONES",20,e),e+=10,h.setFontSize(9),h.setFont("helvetica","normal"),v.split("\n").forEach(a=>{e>270&&(h.addPage(),e=20),h.text(a,20,e),e+=4})}if(s.notas){let e=(null===(p=h.lastAutoTable)||void 0===p?void 0:p.finalY)?h.lastAutoTable.finalY+50:200;e>250&&(h.addPage(),e=20),h.setFontSize(12),h.setFont("helvetica","bold"),h.text("NOTAS",20,e),e+=10,h.setFontSize(9),h.setFont("helvetica","normal"),s.notas.split("\n").forEach(a=>{e>270&&(h.addPage(),e=20),h.text(a,20,e),e+=4})}if(null===(x=i.cotizaciones)||void 0===x?void 0:x.notaPie){let e=h.internal.pageSize.height;h.setFontSize(8),h.setTextColor(120,120,120),h.text(i.cotizaciones.notaPie,20,e-15)}let N="cotizacion-".concat(s.numero.replace(/[^a-zA-Z0-9]/g,"-"),".pdf");h.save(N)},className:"p-2 text-slate-500 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"Descargar PDF",children:(0,t.jsx)(ek.Z,{className:"w-5 h-5"})}),"borrador"===s.estado&&(0,t.jsxs)("button",{onClick:()=>m(s.id,{estado:"enviada"}),className:"bg-blue-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-600 transition-colors flex items-center space-x-2",children:[(0,t.jsx)(en.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Enviar al Cliente"})]}),"enviada"===s.estado&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:f,className:"bg-emerald-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-emerald-600 transition-colors flex items-center space-x-2",children:[(0,t.jsx)(eP.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Aprobar"})]}),(0,t.jsxs)("button",{onClick:()=>p(!0),className:"bg-red-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-red-600 transition-colors flex items-center space-x-2",children:[(0,t.jsx)(ej.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Rechazar"})]})]})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(ei.Z,{className:"w-5 h-5 text-slate-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm",children:"Fecha de emisi\xf3n"}),(0,t.jsx)("p",{className:"font-medium",children:j(s.fecha)})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(ei.Z,{className:"w-5 h-5 text-slate-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm",children:"V\xe1lida hasta"}),(0,t.jsxs)("p",{className:"font-medium ".concat(y?"text-red-600":""),children:[j(s.fechaValidez),"enviada"===s.estado&&(0,t.jsxs)("span",{className:"ml-2 text-xs ".concat(N<=3?"text-red-600":"text-slate-500"),children:["(",N>0?"".concat(N," d\xedas restantes"):"Vencida",")"]})]})]})]}),s.fechaAprobacion&&(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(eP.Z,{className:"w-5 h-5 text-emerald-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm",children:"Fecha de aprobaci\xf3n"}),(0,t.jsx)("p",{className:"font-medium text-emerald-600",children:j(s.fechaAprobacion)})]})]}),s.fechaRechazo&&(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(ej.Z,{className:"w-5 h-5 text-red-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm",children:"Fecha de rechazo"}),(0,t.jsx)("p",{className:"font-medium text-red-600",children:j(s.fechaRechazo)})]})]})]}),s.motivoRechazo&&(0,t.jsxs)("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-xl",children:[(0,t.jsx)("p",{className:"text-red-800 font-medium mb-1",children:"Motivo del rechazo:"}),(0,t.jsx)("p",{className:"text-red-700",children:s.motivoRechazo})]})]}),b&&(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,t.jsx)("div",{className:"p-3 bg-purple-50 rounded-xl",children:(0,t.jsx)(eO.Z,{className:"w-6 h-6 text-purple-600"})}),(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Informaci\xf3n del Cliente"})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm mb-1",children:"Nombre"}),(0,t.jsx)("p",{className:"font-semibold text-slate-800",children:b.nombre})]}),b.empresa&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm mb-1",children:"Empresa"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(ew.Z,{className:"w-4 h-4 text-slate-500"}),(0,t.jsx)("p",{className:"font-medium text-slate-800",children:b.empresa})]})]}),b.nit&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm mb-1",children:"NIT/C\xe9dula"}),(0,t.jsx)("p",{className:"font-medium text-slate-800",children:b.nit})]}),b.email&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm mb-1",children:"Email"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(eC.Z,{className:"w-4 h-4 text-slate-500"}),(0,t.jsx)("p",{className:"text-slate-800",children:b.email})]})]}),b.telefono&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm mb-1",children:"Tel\xe9fono"}),(0,t.jsx)("p",{className:"text-slate-800",children:b.telefono})]}),b.ciudad&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm mb-1",children:"Ciudad"}),(0,t.jsx)("p",{className:"text-slate-800",children:b.ciudad})]})]}),b.direccion&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm mb-1",children:"Direcci\xf3n"}),(0,t.jsx)("p",{className:"text-slate-800",children:b.direccion})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,t.jsx)("div",{className:"p-3 bg-indigo-50 rounded-xl",children:(0,t.jsx)(Z.Z,{className:"w-6 h-6 text-indigo-600"})}),(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Servicios Cotizados"})]}),(0,t.jsx)("div",{className:"space-y-4",children:null===(a=s.items)||void 0===a?void 0:a.map((e,a)=>{let s=l.find(a=>a.id===e.servicio_id);return(0,t.jsxs)("div",{className:"border border-slate-200 rounded-xl p-6",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"font-semibold text-slate-800 mb-2",children:(null==s?void 0:s.nombre)||"Servicio no encontrado"}),(0,t.jsx)("p",{className:"text-slate-600 text-sm mb-3",children:e.descripcion})]}),(0,t.jsxs)("div",{className:"text-right ml-6",children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm",children:"Subtotal"}),(0,t.jsx)("p",{className:"font-bold text-emerald-600 text-lg",children:eh(e.subtotal)})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-4 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500",children:"Cantidad"}),(0,t.jsx)("p",{className:"font-medium",children:e.cantidad})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500",children:"Precio Unitario"}),(0,t.jsx)("p",{className:"font-medium",children:eh(e.precio_unitario)})]}),e.descuento_porcentaje>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500",children:"Descuento"}),(0,t.jsxs)("p",{className:"font-medium text-red-600",children:[e.descuento_porcentaje,"%"]})]})]}),e.notas&&(0,t.jsx)("div",{className:"mt-4 p-3 bg-slate-50 rounded-lg",children:(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:e.notas})})]},a)})}),(0,t.jsx)("div",{className:"border-t border-slate-200 mt-8 pt-6",children:(0,t.jsxs)("div",{className:"max-w-md ml-auto space-y-3",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"Subtotal:"}),(0,t.jsx)("span",{className:"font-medium",children:eh(s.subtotal)})]}),s.descuentoValor>0&&(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsxs)("span",{className:"text-slate-600",children:["Descuento (",s.descuentoPorcentaje,"%):"]}),(0,t.jsxs)("span",{className:"text-red-600",children:["-",eh(s.descuentoValor)]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"IVA:"}),(0,t.jsx)("span",{className:"font-medium",children:eh(s.iva)})]}),(0,t.jsxs)("div",{className:"border-t border-slate-300 pt-3 flex justify-between",children:[(0,t.jsx)("span",{className:"font-bold text-slate-800 text-lg",children:"Total:"}),(0,t.jsx)("span",{className:"font-bold text-emerald-600 text-xl",children:eh(s.total)})]})]})})]}),(s.notas||s.terminosCondiciones)&&(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800 mb-6",children:"Informaci\xf3n Adicional"}),s.notas&&(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("h3",{className:"font-semibold text-slate-700 mb-2",children:"Notas"}),(0,t.jsx)("div",{className:"p-4 bg-slate-50 rounded-xl",children:(0,t.jsx)("p",{className:"text-slate-700 whitespace-pre-wrap",children:s.notas})})]}),s.terminosCondiciones&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-slate-700 mb-2",children:"T\xe9rminos y Condiciones"}),(0,t.jsx)("div",{className:"p-4 bg-slate-50 rounded-xl",children:(0,t.jsx)("p",{className:"text-slate-700 whitespace-pre-wrap",children:s.terminosCondiciones})})]})]}),x&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl p-8 max-w-md w-full mx-4",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-slate-800 mb-4",children:"Rechazar Cotizaci\xf3n"}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Motivo del rechazo"}),(0,t.jsx)("textarea",{value:h,onChange:e=>u(e.target.value),rows:4,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all resize-none",placeholder:"Explica el motivo del rechazo..."})]}),(0,t.jsxs)("div",{className:"flex space-x-3",children:[(0,t.jsx)("button",{onClick:v,disabled:!h.trim(),className:"flex-1 bg-red-500 text-white px-6 py-3 rounded-xl font-medium hover:bg-red-600 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors",children:"Rechazar"}),(0,t.jsx)("button",{onClick:()=>{p(!1),u("")},className:"px-6 py-3 border border-slate-300 text-slate-700 rounded-xl font-medium hover:bg-slate-50 transition-colors",children:"Cancelar"})]})]})})]})},eM=e=>{let{cotizaciones:a,clientes:s,servicios:r,configuracion:l,onCrearCotizacion:i,onActualizarCotizacion:n,onAprobarCotizacion:c,onRechazarCotizacion:d,onEliminarCotizacion:m}=e,[x,p]=(0,o.useState)("lista"),[h,u]=(0,o.useState)(null),[b,g]=(0,o.useState)("todos"),[j,f]=(0,o.useState)(""),v=e=>{let a=Y.find(a=>a.value===e);return(null==a?void 0:a.color)||"gray"},N=e=>{let a=Y.find(a=>a.value===e);return(null==a?void 0:a.label)||e},y=e=>new Date(e).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"}),w=e=>{let a=new Date;return Math.ceil((new Date(e).getTime()-a.getTime())/864e5)},C=e=>{u(e),p("ver")},E=async e=>{if(confirm("\xbfConfirmas el env\xedo de esta cotizaci\xf3n al cliente?"))try{await n(e,{estado:"enviada"}),alert("Cotizaci\xf3n enviada exitosamente")}catch(e){console.error("Error al enviar cotizaci\xf3n:",e),alert("Error al enviar la cotizaci\xf3n")}},z=async e=>{if(confirm("\xbfConfirmas la aprobaci\xf3n de esta cotizaci\xf3n? Se crear\xe1 autom\xe1ticamente un proyecto."))try{await c(e),alert("Cotizaci\xf3n aprobada y proyecto creado exitosamente")}catch(e){console.error("Error al aprobar cotizaci\xf3n:",e),alert("Error al aprobar la cotizaci\xf3n")}},S=async e=>{let a=prompt("Motivo del rechazo (opcional):");if(null!==a)try{await d(e,a||"Sin motivo especificado")}catch(e){console.error("Error al rechazar cotizaci\xf3n:",e),alert("Error al rechazar la cotizaci\xf3n")}},D=async e=>{if(confirm("\xbfEst\xe1s seguro de que deseas eliminar esta cotizaci\xf3n? Esta acci\xf3n no se puede deshacer."))try{await m(e),alert("Cotizaci\xf3n eliminada exitosamente")}catch(e){console.error("Error al eliminar cotizaci\xf3n:",e),alert("Error al eliminar la cotizaci\xf3n")}},P=a.filter(e=>{var a;let s="todos"===b||e.estado===b,t=""===j||e.numero.toLowerCase().includes(j.toLowerCase())||(null===(a=e.clienteNombre)||void 0===a?void 0:a.toLowerCase().includes(j.toLowerCase()));return s&&t}),_={total:a.length,borradores:a.filter(e=>"borrador"===e.estado).length,enviadas:a.filter(e=>"enviada"===e.estado).length,aprobadas:a.filter(e=>"aprobada"===e.estado).length,valorTotal:a.reduce((e,a)=>e+(a.total||0),0),valorAprobado:a.filter(e=>"aprobada"===e.estado).reduce((e,a)=>e+(a.total||0),0)};return"crear"===x?(0,t.jsx)(eI,{clientes:s,servicios:r,onCrear:i,onCancelar:()=>p("lista")}):"ver"===x&&h?(0,t.jsx)(eV,{cotizacion:h,clientes:s,servicios:r,configuracion:l,onVolver:()=>{p("lista"),u(null)},onAprobar:z,onRechazar:S,onActualizar:n}):(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Total Cotizaciones"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-slate-800",children:_.total})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center",children:(0,t.jsx)(Z.Z,{className:"w-6 h-6 text-blue-600"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Enviadas"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:_.enviadas})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center",children:(0,t.jsx)(en.Z,{className:"w-6 h-6 text-blue-600"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Aprobadas"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-emerald-600",children:_.aprobadas})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-emerald-50 rounded-lg flex items-center justify-center",children:(0,t.jsx)(eP.Z,{className:"w-6 h-6 text-emerald-600"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Valor Aprobado"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-emerald-600",children:eh(_.valorAprobado)})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-emerald-50 rounded-lg flex items-center justify-center",children:(0,t.jsx)(eP.Z,{className:"w-6 h-6 text-emerald-600"})})]})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"p-3 bg-indigo-50 rounded-xl",children:(0,t.jsx)(Z.Z,{className:"w-6 h-6 text-indigo-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Gesti\xf3n de Cotizaciones"}),(0,t.jsxs)("p",{className:"text-slate-600",children:[P.length," cotizaciones"]})]})]}),(0,t.jsxs)("button",{onClick:()=>p("crear"),className:"bg-indigo-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-indigo-600 transition-colors flex items-center space-x-2",children:[(0,t.jsx)(ef.Z,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:"Nueva Cotizaci\xf3n"})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(e_.Z,{className:"absolute left-3 top-3 w-5 h-5 text-slate-400"}),(0,t.jsx)("input",{type:"text",value:j,onChange:e=>f(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",placeholder:"Buscar por n\xfamero o cliente..."})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(eT.Z,{className:"absolute left-3 top-3 w-5 h-5 text-slate-400"}),(0,t.jsxs)("select",{value:b,onChange:e=>g(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all appearance-none",children:[(0,t.jsx)("option",{value:"todos",children:"Todos los estados"}),Y.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))]})]})]}),0===P.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(Z.Z,{className:"w-8 h-8 text-slate-400"})}),(0,t.jsx)("p",{className:"text-slate-600 mb-2",children:j||"todos"!==b?"No se encontraron cotizaciones":"No hay cotizaciones registradas"}),(0,t.jsx)("p",{className:"text-slate-500 text-sm",children:j||"todos"!==b?"Intenta con otros filtros":"Crea tu primera cotizaci\xf3n para comenzar"})]}):(0,t.jsx)("div",{className:"space-y-4",children:P.map(e=>{let a=w(e.fechaValidez),s=a<0&&"enviada"===e.estado;return(0,t.jsx)("div",{className:"border border-slate-200 rounded-xl p-6 hover:shadow-md transition-all",children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,t.jsx)("h3",{className:"font-bold text-slate-800 text-lg",children:e.numero}),(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-".concat(v(e.estado),"-100 text-").concat(v(e.estado),"-700"),children:N(e.estado)}),s&&(0,t.jsxs)("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700 flex items-center space-x-1",children:[(0,t.jsx)(el.Z,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:"Vencida"})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500",children:"Cliente"}),(0,t.jsx)("p",{className:"font-semibold text-slate-800",children:e.clienteNombre})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500",children:"Fecha"}),(0,t.jsx)("p",{className:"text-slate-700",children:y(e.fecha)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500",children:"Validez"}),(0,t.jsxs)("p",{className:"text-slate-700 ".concat(s?"text-red-600 font-semibold":""),children:[y(e.fechaValidez),"enviada"===e.estado&&(0,t.jsxs)("span",{className:"ml-1 text-xs ".concat(a<=3?"text-red-600":"text-slate-500"),children:["(",a>0?"".concat(a," d\xedas"):"Vencida",")"]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500",children:"Valor Total"}),(0,t.jsx)("p",{className:"font-bold text-emerald-600 text-lg",children:eh(e.total)})]})]}),e.notas&&(0,t.jsx)("div",{className:"mt-3 p-3 bg-slate-50 rounded-lg",children:(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:e.notas})})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 ml-6",children:[(0,t.jsx)("button",{onClick:()=>C(e),className:"p-2 text-slate-500 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"Ver cotizaci\xf3n",children:(0,t.jsx)(eF.Z,{className:"w-5 h-5"})}),"borrador"===e.estado&&(0,t.jsx)("button",{onClick:()=>E(e.id),className:"p-2 text-slate-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Enviar cotizaci\xf3n al cliente",children:(0,t.jsx)(en.Z,{className:"w-5 h-5"})}),"enviada"===e.estado&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>z(e.id),className:"p-2 text-slate-500 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition-colors",title:"Aprobar cotizaci\xf3n",children:(0,t.jsx)(eP.Z,{className:"w-5 h-5"})}),(0,t.jsx)("button",{onClick:()=>S(e.id),className:"p-2 text-slate-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Rechazar cotizaci\xf3n",children:(0,t.jsx)(ej.Z,{className:"w-5 h-5"})})]}),("borrador"===e.estado||"rechazada"===e.estado)&&(0,t.jsx)("button",{onClick:()=>D(e.id),className:"p-2 text-slate-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar cotizaci\xf3n",children:(0,t.jsx)(eN.Z,{className:"w-5 h-5"})})]})]})},e.id)})})]})]})};var eL=s(45062),eB=s(44101),eU=s(73750),eG=s(97818);let eq=e=>{console.log("\uD83D\uDD0D DEBUG - Creando plan inicial con proyecto:",e);let a=new Date().toISOString().split("T")[0],s=e.valorTotal||0,t=s>0?(.5*s).toString():"100000";console.log("\uD83D\uDD0D DEBUG - Valores calculados:",{valorTotal:s,montoDefecto:t,fechaDefecto:a,porcentaje:s>0?"50":"100"});let r={descripcion:"Pago del proyecto",fechaVencimiento:a,monto:t,tipo:"cuota",porcentajeProyecto:s>0?"50":"100"};return console.log("\uD83D\uDD0D DEBUG - Plan inicial creado:",r),r},eY=e=>{let{proyecto:a,onCrear:s,onCerrar:r}=e;console.log("\uD83D\uDE80 DEBUG - CrearPlanPago iniciado con proyecto:",a);let l=eq(a);console.log("\uD83D\uDE80 DEBUG - Plan inicial generado:",l);let[i,n]=(0,o.useState)([l]),[c,d]=(0,o.useState)(""),[m,x]=(0,o.useState)(!1);(0,o.useEffect)(()=>{console.log("\uD83D\uDD04 DEBUG - Planes actualizados:",i)},[i]);let p=e=>{i.length>1&&n(i.filter((a,s)=>s!==e))},h=(e,s,t)=>{console.log("\uD83D\uDD27 DEBUG - Actualizando plan ".concat(e,", campo: ").concat(s,", valor:"),t);let r=[...i];if(r[e]={...r[e],[s]:t},"porcentajeProyecto"===s){let s=parseFloat(t)||0,l=a.valorTotal||0,o=l>0?(l*s/100).toString():"0";r[e].monto=o,console.log("\uD83D\uDD27 DEBUG - Calculado monto autom\xe1tico: ".concat(o," (").concat(s,"% de ").concat(l,")"))}if("monto"===s){let s=parseFloat(t.replace(/[^\d]/g,""))||0,l=a.valorTotal||0,o=l>0?s/l*100:0;r[e].porcentajeProyecto=o.toFixed(1),console.log("\uD83D\uDD27 DEBUG - Calculado porcentaje autom\xe1tico: ".concat(o,"% (").concat(s," de ").concat(l,")"))}console.log("\uD83D\uDD27 DEBUG - Plan actualizado:",r[e]),n(r)},u=e=>{if(ee.find(a=>a.nombre===e)){if("50% - 50%"===e){let e=new Date;e.getTime(),n([{descripcion:"Anticipo del 50%",fechaVencimiento:e.toISOString().split("T")[0],monto:(.5*a.valorTotal).toString(),tipo:"anticipo",porcentajeProyecto:"50"},{descripcion:"Pago final del 50%",fechaVencimiento:a.fechaFinEstimada,monto:(.5*a.valorTotal).toString(),tipo:"final",porcentajeProyecto:"50"}])}else if("40% - 40% - 20%"===e){let e=new Date,s=new Date(a.fechaInicio?a.fechaInicio:e),t=new Date(a.fechaFinEstimada?a.fechaFinEstimada:e.getTime()+5184e6);isNaN(s.getTime())&&(s=new Date(e)),isNaN(t.getTime())&&(t=new Date(e.getTime()+5184e6));let r=t.getTime()-s.getTime(),l=new Date(s.getTime()+r/2);n([{descripcion:"Anticipo del 40%",fechaVencimiento:e.toISOString().split("T")[0],monto:(.4*a.valorTotal).toString(),tipo:"anticipo",porcentajeProyecto:"40"},{descripcion:"Pago de avance del 40%",fechaVencimiento:l.toISOString().split("T")[0],monto:(.4*a.valorTotal).toString(),tipo:"cuota",porcentajeProyecto:"40"},{descripcion:"Pago final del 20%",fechaVencimiento:a.fechaFinEstimada||t.toISOString().split("T")[0],monto:(.2*a.valorTotal).toString(),tipo:"final",porcentajeProyecto:"20"}])}d(e)}},b=()=>i.reduce((e,a)=>e+(parseFloat(a.porcentajeProyecto)||0),0),g=async()=>{console.log("\uD83D\uDD0D DEBUG - Validando planes antes de guardar:",i),console.log("\uD83D\uDD0D DEBUG - Proyecto actual:",a);let e=[];if(i.forEach((a,s)=>{let t="Cuota #".concat(s+1);console.log("\uD83D\uDD0D DEBUG - Validando ".concat(t,":"),a),a.descripcion.trim()||(e.push("".concat(t,": Falta descripci\xf3n")),console.log("❌ ERROR - ".concat(t,": descripci\xf3n vac\xeda"))),a.fechaVencimiento||(e.push("".concat(t,": Falta fecha de vencimiento")),console.log("❌ ERROR - ".concat(t,": fecha vac\xeda, valor:"),a.fechaVencimiento)),console.log("\uD83D\uDD0D DEBUG - ".concat(t," monto original:"),a.monto);let r=a.monto.replace(/[^\d]/g,"");console.log("\uD83D\uDD0D DEBUG - ".concat(t," monto limpio:"),r);let l=parseFloat(r)||0;console.log("\uD83D\uDD0D DEBUG - ".concat(t," monto num\xe9rico:"),l),l<=0&&(e.push("".concat(t,": El monto debe ser mayor a 0")),console.log("❌ ERROR - ".concat(t,": monto inv\xe1lido:"),l));let o=parseFloat(a.porcentajeProyecto)||0;o<=0&&(e.push("".concat(t,": El porcentaje debe ser mayor a 0")),console.log("❌ ERROR - ".concat(t,": porcentaje inv\xe1lido:"),o))}),e.length>0){alert("Se encontraron los siguientes errores:\n\n"+e.join("\n"));return}let t=b();if(!(Math.abs(t-100)>.1)||confirm("El total de porcentajes es ".concat(t.toFixed(1),"%. \xbfDeseas continuar?"))){x(!0);try{for(let e=0;e<i.length;e++){let t=i[e];await s({proyectoId:a.id,numeroCuota:e+1,descripcion:t.descripcion,fechaVencimiento:t.fechaVencimiento,monto:parseFloat(t.monto.replace(/[^\d]/g,""))||0,tipo:t.tipo,porcentajeProyecto:parseFloat(t.porcentajeProyecto)||0,estado:"pendiente"})}r()}catch(e){console.error("Error al crear planes de pago:",e),alert("Error al crear los planes de pago")}finally{x(!1)}}},j=b();return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsx)("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:(0,t.jsxs)("div",{className:"p-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:"Crear Plan de Pagos"}),(0,t.jsxs)("p",{className:"text-slate-600",children:["Proyecto: ",a.nombre]}),(0,t.jsxs)("p",{className:"text-slate-600",children:["Valor total: ",(0,t.jsx)("span",{className:"font-bold text-emerald-600",children:eh(a.valorTotal||0)})]}),(!a.valorTotal||0===a.valorTotal)&&(0,t.jsx)("div",{className:"mt-2 p-2 bg-orange-50 border border-orange-200 rounded-lg",children:(0,t.jsx)("p",{className:"text-sm text-orange-700",children:"⚠️ El proyecto no tiene valor total definido. Ajusta los montos manualmente."})})]}),(0,t.jsx)("button",{onClick:r,className:"p-2 text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded-lg transition-colors",children:(0,t.jsx)(ej.Z,{className:"w-6 h-6"})})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)("h3",{className:"font-semibold text-slate-700",children:"Plantillas de Pago"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("button",{onClick:()=>{console.log("\uD83D\uDD04 DEBUG - Reiniciando planes con valores por defecto"),n([eq(a)])},className:"text-xs bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600",children:"\uD83D\uDD04 Reset"}),(0,t.jsx)("div",{className:"text-xs text-slate-500 bg-slate-50 px-2 py-1 rounded",children:"\uD83D\uDCA1 Usa las plantillas para configurar r\xe1pidamente"})]})]}),(0,t.jsx)("div",{className:"grid md:grid-cols-3 gap-3",children:ee.slice(0,3).map(e=>(0,t.jsxs)("button",{onClick:()=>u(e.nombre),className:"p-3 border rounded-lg text-left hover:border-indigo-300 transition-colors ".concat(c===e.nombre?"border-indigo-500 bg-indigo-50":"border-slate-200"),children:[(0,t.jsx)("p",{className:"font-medium text-slate-800",children:e.nombre}),(0,t.jsx)("p",{className:"text-sm text-slate-600",children:e.descripcion})]},e.nombre))})]}),(0,t.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-slate-700",children:"Cuotas de Pago"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[(0,t.jsxs)("span",{className:"text-sm text-slate-600",children:["Total: ",j.toFixed(1),"%"]}),(0,t.jsx)("div",{className:"text-xs px-2 py-1 rounded-full ".concat(.1>Math.abs(j-100)?"bg-emerald-100 text-emerald-700":"bg-orange-100 text-orange-700"),children:.1>Math.abs(j-100)?"✓ Completo":"⚠ Ajustar"})]})]}),(0,t.jsxs)("button",{onClick:()=>{n([...i,eq(a)])},className:"bg-indigo-500 text-white px-3 py-1 rounded-lg text-sm hover:bg-indigo-600 transition-colors flex items-center space-x-1",children:[(0,t.jsx)(ef.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Agregar Cuota"})]})]}),i.map((e,a)=>(0,t.jsxs)("div",{className:"border border-slate-200 rounded-xl p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("h4",{className:"font-medium text-slate-800",children:["Cuota #",a+1]}),i.length>1&&(0,t.jsx)("button",{onClick:()=>p(a),className:"p-1 text-slate-500 hover:text-red-600 hover:bg-red-50 rounded",children:(0,t.jsx)(eG.Z,{className:"w-4 h-4"})})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Descripci\xf3n"}),(0,t.jsx)("input",{type:"text",value:e.descripcion,onChange:e=>h(a,"descripcion",e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",placeholder:"Ej: Anticipo del 50%"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Tipo de Pago"}),(0,t.jsx)("select",{value:e.tipo,onChange:e=>h(a,"tipo",e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",children:H.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Fecha de Vencimiento"}),(0,t.jsx)("input",{type:"date",value:e.fechaVencimiento,onChange:e=>h(a,"fechaVencimiento",e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Porcentaje (%)"}),(0,t.jsx)("input",{type:"number",step:"0.1",min:"0",max:"100",value:e.porcentajeProyecto,onChange:e=>h(a,"porcentajeProyecto",e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",placeholder:"50"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Monto"}),(0,t.jsx)("input",{type:"text",value:ex(e.monto),onChange:e=>h(a,"monto",e.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",placeholder:"1000000"})]})]})]})]},a))]}),(0,t.jsxs)("div",{className:"bg-slate-50 rounded-xl p-4 mb-6",children:[(0,t.jsx)("h4",{className:"font-semibold text-slate-800 mb-3",children:"Resumen del Plan"}),(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600",children:"Total de cuotas:"}),(0,t.jsx)("p",{className:"font-bold text-slate-800",children:i.length})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600",children:"Total porcentaje:"}),(0,t.jsxs)("p",{className:"font-bold ".concat(.1>=Math.abs(j-100)?"text-emerald-600":"text-red-600"),children:[j.toFixed(1),"%"]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600",children:"Total monto:"}),(0,t.jsx)("p",{className:"font-bold text-emerald-600",children:eh(i.reduce((e,a)=>e+(parseFloat(a.monto.replace(/[^\d]/g,""))||0),0))})]})]}),Math.abs(j-100)>.1&&(0,t.jsx)("div",{className:"mt-3 p-2 bg-orange-100 border border-orange-200 rounded-lg",children:(0,t.jsxs)("p",{className:"text-orange-800 text-sm",children:["⚠️ El total de porcentajes debe sumar 100%. Actualmente suma ",j.toFixed(1),"%."]})})]}),(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsxs)("button",{onClick:g,disabled:m||0===i.length,className:"flex-1 bg-indigo-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-indigo-600 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center space-x-2",children:[(0,t.jsx)(ei.Z,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:m?"Creando...":"Crear Plan de Pagos"})]}),(0,t.jsx)("button",{onClick:r,className:"px-6 py-3 border border-slate-300 text-slate-700 rounded-xl font-semibold hover:bg-slate-50 transition-colors",children:"Cancelar"})]})]})})})},eK={planPagoId:"",fecha:new Date().toISOString().split("T")[0],monto:"",metodoPago:"transferencia",numeroReferencia:"",notas:""},eH=e=>{var a;let{proyecto:s,planesPago:r,onRegistrar:l,onCerrar:i}=e,[n,c]=(0,o.useState)(eK),[d,m]=(0,o.useState)(!1),x=r.filter(e=>"pendiente"===e.estado||"parcial"===e.estado),p=(e,a)=>{if(c(s=>({...s,[e]:a})),"planPagoId"===e&&a){let e=r.find(e=>e.id===a);e&&c(a=>({...a,monto:e.monto.toString()}))}},h=async()=>{if(!n.fecha||!n.monto){alert("La fecha y el monto son obligatorios");return}let e=parseFloat(n.monto.replace(/[^\d]/g,""))||0;if(e<=0){alert("El monto debe ser mayor a cero");return}if(n.planPagoId){let a=r.find(e=>e.id===n.planPagoId);if(a&&e>a.monto&&!confirm("El monto (".concat(eh(e),") es mayor al monto del plan (").concat(eh(a.monto),"). \xbfDeseas continuar?")))return}m(!0);try{await l({proyectoId:s.id,planPagoId:n.planPagoId||void 0,fecha:n.fecha,monto:e,metodoPago:n.metodoPago,numeroReferencia:n.numeroReferencia||void 0,notas:n.notas||void 0}),i()}catch(e){console.error("Error al registrar pago:",e),alert("Error al registrar el pago")}finally{m(!1)}},u=n.planPagoId?r.find(e=>e.id===n.planPagoId):null;return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsx)("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,t.jsxs)("div",{className:"p-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:"Registrar Pago"}),(0,t.jsxs)("p",{className:"text-slate-600",children:["Proyecto: ",s.nombre]})]}),(0,t.jsx)("button",{onClick:i,className:"p-2 text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded-lg transition-colors",children:(0,t.jsx)(ej.Z,{className:"w-6 h-6"})})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Plan de Pago (Opcional)"}),(0,t.jsxs)("select",{value:n.planPagoId,onChange:e=>p("planPagoId",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all",children:[(0,t.jsx)("option",{value:"",children:"Pago no asociado a plan espec\xedfico"}),x.map(e=>(0,t.jsxs)("option",{value:e.id,children:["Cuota #",e.numeroCuota," - ",e.descripcion," (",eh(e.monto),")"]},e.id))]}),(0,t.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Si no seleccionas un plan, ser\xe1 un pago general al proyecto"})]}),u&&(0,t.jsxs)("div",{className:"bg-emerald-50 border border-emerald-200 rounded-xl p-4",children:[(0,t.jsx)("h3",{className:"font-semibold text-emerald-800 mb-2",children:"Plan Seleccionado"}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-emerald-600",children:"Descripci\xf3n:"}),(0,t.jsx)("span",{className:"ml-2 font-medium",children:u.descripcion})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-emerald-600",children:"Monto:"}),(0,t.jsx)("span",{className:"ml-2 font-medium",children:eh(u.monto)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-emerald-600",children:"Vencimiento:"}),(0,t.jsx)("span",{className:"ml-2 font-medium",children:new Date(u.fechaVencimiento).toLocaleDateString("es-CO")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-emerald-600",children:"Estado:"}),(0,t.jsx)("span",{className:"ml-2 font-medium ".concat("pendiente"===u.estado?"text-orange-600":"text-yellow-600"),children:"pendiente"===u.estado?"Pendiente":"Parcial"})]})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Fecha del Pago *"}),(0,t.jsx)("input",{type:"date",value:n.fecha,onChange:e=>p("fecha",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Monto Recibido *"}),(0,t.jsx)("input",{type:"text",value:ex(n.monto),onChange:e=>p("monto",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all",placeholder:"1000000"})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"M\xe9todo de Pago"}),(0,t.jsx)("select",{value:n.metodoPago,onChange:e=>p("metodoPago",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all",children:$.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"N\xfamero de Referencia"}),(0,t.jsx)("input",{type:"text",value:n.numeroReferencia,onChange:e=>p("numeroReferencia",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all",placeholder:"N\xfamero de transacci\xf3n, cheque, etc."})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Notas"}),(0,t.jsx)("textarea",{value:n.notas,onChange:e=>p("notas",e.target.value),rows:3,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:border-transparent transition-all resize-none",placeholder:"Informaci\xf3n adicional sobre el pago..."})]}),n.monto&&(0,t.jsxs)("div",{className:"bg-slate-50 rounded-xl p-4",children:[(0,t.jsx)("h4",{className:"font-semibold text-slate-800 mb-3",children:"Resumen del Pago"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"Monto a registrar:"}),(0,t.jsx)("span",{className:"font-bold text-emerald-600",children:eh(parseFloat(n.monto.replace(/[^\d]/g,""))||0)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"M\xe9todo:"}),(0,t.jsx)("span",{className:"font-medium",children:null===(a=$.find(e=>e.value===n.metodoPago))||void 0===a?void 0:a.label})]}),u&&(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"Asociado a:"}),(0,t.jsx)("span",{className:"font-medium",children:u.descripcion})]})]})]}),(0,t.jsxs)("div",{className:"flex space-x-4 pt-4",children:[(0,t.jsxs)("button",{onClick:h,disabled:d||!n.fecha||!n.monto,className:"flex-1 bg-emerald-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-emerald-600 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center space-x-2",children:[(0,t.jsx)(eo.Z,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:d?"Registrando...":"Registrar Pago"})]}),(0,t.jsx)("button",{onClick:i,className:"px-6 py-3 border border-slate-300 text-slate-700 rounded-xl font-semibold hover:bg-slate-50 transition-colors",children:"Cancelar"})]})]})]})})})},e$={categoriaId:"",fecha:new Date().toISOString().split("T")[0],descripcion:"",monto:"",proveedor:"",numeroFactura:"",metodoPago:"transferencia",estado:"pagado",aprobadoPor:"",notas:""},eQ=e=>{var a;let{proyecto:s,onAgregar:r,onCerrar:l}=e,[i,n]=(0,o.useState)(e$),[c,d]=(0,o.useState)([]),[m,x]=(0,o.useState)(!1),[p,h]=(0,o.useState)(!1),[u,b]=(0,o.useState)({nombre:"",descripcion:"",tipo:"variable"});(0,o.useEffect)(()=>{j()},[]);let j=async()=>{try{let e=await g.obtenerTodas();d(e)}catch(e){console.error("Error al cargar categor\xedas:",e)}},f=(e,a)=>{n(s=>({...s,[e]:a}))},v=async()=>{if(!u.nombre.trim()){alert("El nombre de la categor\xeda es obligatorio");return}try{await g.crear({nombre:u.nombre,descripcion:u.descripcion||void 0,tipo:u.tipo}),await j(),h(!1),b({nombre:"",descripcion:"",tipo:"variable"})}catch(e){console.error("Error al crear categor\xeda:",e),alert("Error al crear la categor\xeda")}},N=async()=>{if(!i.categoriaId||!i.descripcion||!i.monto||!i.fecha){alert("Los campos categor\xeda, descripci\xf3n, monto y fecha son obligatorios");return}let e=parseFloat(i.monto.replace(/[^\d]/g,""))||0;if(e<=0){alert("El monto debe ser mayor a cero");return}x(!0);try{await r({proyectoId:s.id,categoriaId:i.categoriaId,fecha:i.fecha,descripcion:i.descripcion,monto:e,proveedor:i.proveedor||void 0,numeroFactura:i.numeroFactura||void 0,metodoPago:i.metodoPago,estado:i.estado,aprobadoPor:i.aprobadoPor||void 0,notas:i.notas||void 0}),l()}catch(e){console.error("Error al registrar desembolso:",e),alert("Error al registrar el desembolso")}finally{x(!1)}},y=c.find(e=>e.id===i.categoriaId);return(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,t.jsx)("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,t.jsxs)("div",{className:"p-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-slate-800",children:"Registrar Desembolso"}),(0,t.jsxs)("p",{className:"text-slate-600",children:["Proyecto: ",s.nombre]})]}),(0,t.jsx)("button",{onClick:l,className:"p-2 text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded-lg transition-colors",children:(0,t.jsx)(ej.Z,{className:"w-6 h-6"})})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700",children:"Categor\xeda *"}),(0,t.jsx)("button",{onClick:()=>h(!0),className:"text-xs text-indigo-600 hover:text-indigo-700 font-medium",children:"+ Nueva categor\xeda"})]}),(0,t.jsxs)("select",{value:i.categoriaId,onChange:e=>f("categoriaId",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all",children:[(0,t.jsx)("option",{value:"",children:"Seleccionar categor\xeda..."}),c.map(e=>(0,t.jsx)("option",{value:e.id,children:e.nombre},e.id))]}),(null==y?void 0:y.descripcion)&&(0,t.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:y.descripcion})]}),p&&(0,t.jsxs)("div",{className:"border border-indigo-200 bg-indigo-50 rounded-xl p-4",children:[(0,t.jsx)("h4",{className:"font-semibold text-indigo-800 mb-3",children:"Nueva Categor\xeda"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-3",children:[(0,t.jsx)("input",{type:"text",value:u.nombre,onChange:e=>b(a=>({...a,nombre:e.target.value})),className:"px-3 py-2 border border-indigo-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Nombre de la categor\xeda"}),(0,t.jsxs)("select",{value:u.tipo,onChange:e=>b(a=>({...a,tipo:e.target.value})),className:"px-3 py-2 border border-indigo-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[(0,t.jsx)("option",{value:"variable",children:"Variable"}),(0,t.jsx)("option",{value:"fijo",children:"Fijo"})]})]}),(0,t.jsx)("input",{type:"text",value:u.descripcion,onChange:e=>b(a=>({...a,descripcion:e.target.value})),className:"w-full px-3 py-2 border border-indigo-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Descripci\xf3n (opcional)"}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("button",{onClick:v,className:"bg-indigo-500 text-white px-3 py-1 rounded-lg text-sm hover:bg-indigo-600 transition-colors",children:"Crear"}),(0,t.jsx)("button",{onClick:()=>h(!1),className:"border border-indigo-300 text-indigo-700 px-3 py-1 rounded-lg text-sm hover:bg-indigo-100 transition-colors",children:"Cancelar"})]})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Fecha *"}),(0,t.jsx)("input",{type:"date",value:i.fecha,onChange:e=>f("fecha",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Monto *"}),(0,t.jsx)("input",{type:"text",value:ex(i.monto),onChange:e=>f("monto",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all",placeholder:"150000"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Descripci\xf3n *"}),(0,t.jsx)("input",{type:"text",value:i.descripcion,onChange:e=>f("descripcion",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all",placeholder:"Ej: Compra de materiales para el proyecto"})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Proveedor"}),(0,t.jsx)("input",{type:"text",value:i.proveedor,onChange:e=>f("proveedor",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all",placeholder:"Nombre del proveedor"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"N\xfamero de Factura"}),(0,t.jsx)("input",{type:"text",value:i.numeroFactura,onChange:e=>f("numeroFactura",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all",placeholder:"F-001234"})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"M\xe9todo de Pago"}),(0,t.jsx)("select",{value:i.metodoPago,onChange:e=>f("metodoPago",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all",children:$.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Estado"}),(0,t.jsx)("select",{value:i.estado,onChange:e=>f("estado",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all",children:Q.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]})]}),"aprobado"===i.estado&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Aprobado por"}),(0,t.jsx)("input",{type:"text",value:i.aprobadoPor,onChange:e=>f("aprobadoPor",e.target.value),className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all",placeholder:"Nombre de quien aprueba el gasto"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Notas"}),(0,t.jsx)("textarea",{value:i.notas,onChange:e=>f("notas",e.target.value),rows:3,className:"w-full px-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-transparent transition-all resize-none",placeholder:"Informaci\xf3n adicional sobre el gasto..."})]}),i.monto&&i.descripcion&&(0,t.jsxs)("div",{className:"bg-slate-50 rounded-xl p-4",children:[(0,t.jsx)("h4",{className:"font-semibold text-slate-800 mb-3",children:"Resumen del Desembolso"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"Descripci\xf3n:"}),(0,t.jsx)("span",{className:"font-medium",children:i.descripcion})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"Monto:"}),(0,t.jsx)("span",{className:"font-bold text-red-600",children:eh(parseFloat(i.monto.replace(/[^\d]/g,""))||0)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"Categor\xeda:"}),(0,t.jsx)("span",{className:"font-medium",children:null==y?void 0:y.nombre})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"Estado:"}),(0,t.jsx)("span",{className:"font-medium ".concat("pagado"===i.estado?"text-emerald-600":"aprobado"===i.estado?"text-blue-600":"text-orange-600"),children:null===(a=Q.find(e=>e.value===i.estado))||void 0===a?void 0:a.label})]})]})]}),(0,t.jsxs)("div",{className:"flex space-x-4 pt-4",children:[(0,t.jsxs)("button",{onClick:N,disabled:m||!i.categoriaId||!i.descripcion||!i.monto||!i.fecha,className:"flex-1 bg-red-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-red-600 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center space-x-2",children:[(0,t.jsx)(eU.Z,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:m?"Registrando...":"Registrar Desembolso"})]}),(0,t.jsx)("button",{onClick:l,className:"px-6 py-3 border border-slate-300 text-slate-700 rounded-xl font-semibold hover:bg-slate-50 transition-colors",children:"Cancelar"})]})]})]})})})},eW=e=>{let{proyecto:a,clientes:s,planesPago:r,pagos:l,desembolsos:i,onVolver:n,onActualizarProyecto:c,onCompletarProyecto:d,onCrearPlanPago:m,onRegistrarPago:x,onAgregarDesembolso:p}=e,[h,u]=(0,o.useState)(null),[b,g]=(0,o.useState)(!1),[j,f]=(0,o.useState)(a.progreso.toString()),v=s.find(e=>e.id===a.clienteId),N=e=>{let a=K.find(a=>a.value===e);return(null==a?void 0:a.color)||"gray"},y=e=>new Date(e).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"}),w=r.reduce((e,a)=>e+a.monto,0),C=l.reduce((e,a)=>e+a.monto,0),E=i.filter(e=>"pagado"===e.estado).reduce((e,a)=>e+a.monto,0),z=w-C,S=C-E,D=w>0?C/w*100:0,P=r.filter(e=>"pendiente"===e.estado).length,_=new Date().toISOString().split("T")[0],T=r.filter(e=>"pendiente"===e.estado&&e.fechaVencimiento<_).length,F=(e=>{let a=new Date;return Math.ceil((new Date(e).getTime()-a.getTime())/864e5)})(a.fechaFinEstimada),O=F<0&&"activo"===a.estado,I=async()=>{let e=Math.min(100,Math.max(0,parseFloat(j)||0));try{await c(a.id,{progreso:e}),g(!1)}catch(e){console.error("Error al actualizar progreso:",e),alert("Error al actualizar el progreso")}},A=async()=>{if(confirm("\xbfConfirmas que el proyecto est\xe1 completado?"))try{await d(a.id)}catch(e){console.error("Error al completar proyecto:",e),alert("Error al completar el proyecto")}},k=async e=>{try{await c(a.id,{estado:e})}catch(e){console.error("Error al cambiar estado:",e),alert("Error al cambiar el estado del proyecto")}};return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("button",{onClick:n,className:"p-2 text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded-lg transition-colors",children:(0,t.jsx)(eA.Z,{className:"w-6 h-6"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-slate-800",children:a.nombre}),(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-".concat(N(a.estado),"-100 text-").concat(N(a.estado),"-700"),children:(e=>{let a=K.find(a=>a.value===e);return(null==a?void 0:a.label)||e})(a.estado)}),O&&(0,t.jsxs)("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-red-100 text-red-700 flex items-center space-x-1",children:[(0,t.jsx)(el.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Retrasado"})]})]}),(0,t.jsxs)("p",{className:"text-slate-600",children:["Valor total: ",(0,t.jsx)("span",{className:"font-bold text-emerald-600 text-xl",children:eh(a.valorTotal)})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:["activo"===a.estado&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>k("pausado"),className:"px-4 py-2 border border-orange-300 text-orange-700 rounded-lg hover:bg-orange-50 transition-colors",children:"Pausar"}),(0,t.jsxs)("button",{onClick:A,className:"bg-emerald-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-emerald-600 transition-colors flex items-center space-x-2",children:[(0,t.jsx)(ed.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Completar"})]})]}),"pausado"===a.estado&&(0,t.jsx)("button",{onClick:()=>k("activo"),className:"bg-emerald-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-emerald-600 transition-colors",children:"Reanudar"})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-4 gap-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(ei.Z,{className:"w-5 h-5 text-slate-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm",children:"Fecha de inicio"}),(0,t.jsx)("p",{className:"font-medium",children:y(a.fechaInicio)})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(ei.Z,{className:"w-5 h-5 text-slate-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm",children:"Fecha l\xedmite"}),(0,t.jsxs)("p",{className:"font-medium ".concat(O?"text-red-600":""),children:[y(a.fechaFinEstimada),(0,t.jsxs)("span",{className:"ml-1 text-xs ".concat(F<=7&&F>0?"text-orange-600":O?"text-red-600":"text-slate-500"),children:["(",F>0?"".concat(F," d\xedas"):O?"".concat(Math.abs(F)," d\xedas de retraso"):"Completado",")"]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(er.Z,{className:"w-5 h-5 text-slate-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm",children:"Progreso"}),(0,t.jsx)("div",{className:"flex items-center space-x-2",children:b?(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"number",value:j,onChange:e=>f(e.target.value),min:"0",max:"100",className:"w-16 px-2 py-1 border border-slate-300 rounded text-sm"}),(0,t.jsx)("span",{className:"text-sm",children:"%"}),(0,t.jsx)("button",{onClick:I,className:"p-1 text-emerald-600 hover:bg-emerald-50 rounded",children:(0,t.jsx)(ed.Z,{className:"w-4 h-4"})})]}):(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"w-24 bg-slate-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-emerald-500 h-2 rounded-full transition-all",style:{width:"".concat(a.progreso,"%")}})}),(0,t.jsxs)("span",{className:"font-medium text-slate-700",children:[a.progreso,"%"]}),(0,t.jsx)("button",{onClick:()=>g(!0),className:"p-1 text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded",children:(0,t.jsx)(ev.Z,{className:"w-3 h-3"})})]})})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(et.Z,{className:"w-5 h-5 text-slate-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm",children:"Rentabilidad actual"}),(0,t.jsxs)("p",{className:"font-bold text-lg ".concat(S>=0?"text-emerald-600":"text-red-600"),children:[S>=0?"+":"",eh(S)]})]})]})]}),(P>0||T>0||O)&&(0,t.jsxs)("div",{className:"mt-6 p-4 bg-orange-50 border border-orange-200 rounded-xl",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,t.jsx)(el.Z,{className:"w-5 h-5 text-orange-600"}),(0,t.jsx)("h3",{className:"font-semibold text-orange-800",children:"Alertas del Proyecto"})]}),(0,t.jsxs)("div",{className:"space-y-1 text-sm text-orange-700",children:[T>0&&(0,t.jsxs)("p",{children:["• ",T," pago",T>1?"s":""," vencido",T>1?"s":""]}),P>0&&(0,t.jsxs)("p",{children:["• ",P," pago",P>1?"s":""," pendiente",P>1?"s":""]}),O&&(0,t.jsxs)("p",{children:["• Proyecto retrasado por ",Math.abs(F)," d\xeda",Math.abs(F)>1?"s":""]})]})]})]}),v&&(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,t.jsx)("div",{className:"p-3 bg-purple-50 rounded-xl",children:(0,t.jsx)(eO.Z,{className:"w-6 h-6 text-purple-600"})}),(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Cliente"})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm mb-1",children:"Nombre"}),(0,t.jsx)("p",{className:"font-semibold text-slate-800",children:v.nombre})]}),v.empresa&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm mb-1",children:"Empresa"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(ew.Z,{className:"w-4 h-4 text-slate-500"}),(0,t.jsx)("p",{className:"font-medium text-slate-800",children:v.empresa})]})]}),v.email&&(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500 text-sm mb-1",children:"Email"}),(0,t.jsx)("p",{className:"text-slate-800",children:v.email})]})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-4 gap-6",children:[(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Total Planificado"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-slate-800",children:eh(w)})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center",children:(0,t.jsx)(et.Z,{className:"w-6 h-6 text-blue-600"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Total Cobrado"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-emerald-600",children:eh(C)}),(0,t.jsx)("div",{className:"w-full bg-slate-200 rounded-full h-1 mt-2",children:(0,t.jsx)("div",{className:"bg-emerald-500 h-1 rounded-full",style:{width:"".concat(Math.min(D,100),"%")}})})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-emerald-50 rounded-lg flex items-center justify-center",children:(0,t.jsx)(eo.Z,{className:"w-6 h-6 text-emerald-600"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Total Gastado"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-red-600",children:eh(E)})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-red-50 rounded-lg flex items-center justify-center",children:(0,t.jsx)(eU.Z,{className:"w-6 h-6 text-red-600"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Pendiente Cobro"}),(0,t.jsx)("p",{className:"text-2xl font-bold ".concat(z>0?"text-orange-600":"text-emerald-600"),children:eh(z)})]}),(0,t.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center ".concat(z>0?"bg-orange-50":"bg-emerald-50"),children:(0,t.jsx)(et.Z,{className:"w-6 h-6 ".concat(z>0?"text-orange-600":"text-emerald-600")})})]})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"p-3 bg-blue-50 rounded-xl",children:(0,t.jsx)(ei.Z,{className:"w-6 h-6 text-blue-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Planes de Pago"}),(0,t.jsxs)("p",{className:"text-slate-600",children:[r.length," cuotas configuradas"]})]})]}),(0,t.jsxs)("button",{onClick:()=>u("planPago"),className:"bg-blue-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-600 transition-colors flex items-center space-x-2",children:[(0,t.jsx)(ef.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Nuevo Plan"})]})]}),0===r.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(ei.Z,{className:"w-12 h-12 text-slate-400 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-slate-600 mb-2",children:"No hay planes de pago configurados"}),(0,t.jsx)("p",{className:"text-slate-500 text-sm",children:"Configura los pagos para este proyecto"})]}):(0,t.jsx)("div",{className:"space-y-3",children:r.sort((e,a)=>e.numeroCuota-a.numeroCuota).map(e=>{var a;let s="pendiente"===e.estado&&e.fechaVencimiento<_;return(0,t.jsx)("div",{className:"border rounded-lg p-4 ".concat(s?"border-red-300 bg-red-50":"border-slate-200"),children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,t.jsxs)("span",{className:"font-semibold text-slate-800",children:["Cuota #",e.numeroCuota]}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("pagado"===e.estado?"bg-emerald-100 text-emerald-700":"parcial"===e.estado?"bg-yellow-100 text-yellow-700":s?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"),children:"pagado"===e.estado?"Pagado":"parcial"===e.estado?"Parcial":s?"Vencido":"Pendiente"}),(0,t.jsx)("span",{className:"text-sm text-slate-600",children:e.descripcion})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-slate-500",children:"Monto: "}),(0,t.jsx)("span",{className:"font-semibold",children:eh(e.monto)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-slate-500",children:"Vencimiento: "}),(0,t.jsx)("span",{className:s?"text-red-600 font-semibold":"",children:y(e.fechaVencimiento)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-slate-500",children:"Tipo: "}),(0,t.jsx)("span",{children:null===(a=H.find(a=>a.value===e.tipo))||void 0===a?void 0:a.label})]})]})]}),"pendiente"===e.estado&&(0,t.jsx)("button",{onClick:()=>u("pago"),className:"ml-4 bg-emerald-500 text-white px-3 py-1 rounded-lg text-sm hover:bg-emerald-600 transition-colors",children:"Registrar Pago"})]})},e.id)})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"p-3 bg-emerald-50 rounded-xl",children:(0,t.jsx)(eo.Z,{className:"w-6 h-6 text-emerald-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Historial de Pagos"}),(0,t.jsxs)("p",{className:"text-slate-600",children:[l.length," pagos registrados"]})]})]}),(0,t.jsxs)("button",{onClick:()=>u("pago"),className:"bg-emerald-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-emerald-600 transition-colors flex items-center space-x-2",children:[(0,t.jsx)(ef.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Registrar Pago"})]})]}),0===l.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(eo.Z,{className:"w-12 h-12 text-slate-400 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-slate-600 mb-2",children:"No hay pagos registrados"}),(0,t.jsx)("p",{className:"text-slate-500 text-sm",children:"Los pagos aparecer\xe1n aqu\xed cuando se registren"})]}):(0,t.jsx)("div",{className:"space-y-3",children:l.sort((e,a)=>new Date(a.fecha).getTime()-new Date(e.fecha).getTime()).map(e=>{var a;return(0,t.jsx)("div",{className:"border border-slate-200 rounded-lg p-4",children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-4 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-slate-500",children:"Monto: "}),(0,t.jsx)("span",{className:"font-bold text-emerald-600",children:eh(e.monto)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-slate-500",children:"Fecha: "}),(0,t.jsx)("span",{children:y(e.fecha)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-slate-500",children:"M\xe9todo: "}),(0,t.jsx)("span",{children:null===(a=$.find(a=>a.value===e.metodoPago))||void 0===a?void 0:a.label})]}),e.numeroReferencia&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-slate-500",children:"Ref: "}),(0,t.jsx)("span",{children:e.numeroReferencia})]})]}),e.notas&&(0,t.jsx)("div",{className:"mt-2 p-2 bg-slate-50 rounded text-sm text-slate-600",children:e.notas})]})})},e.id)})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"p-3 bg-red-50 rounded-xl",children:(0,t.jsx)(eU.Z,{className:"w-6 h-6 text-red-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Desembolsos"}),(0,t.jsxs)("p",{className:"text-slate-600",children:[i.length," gastos registrados"]})]})]}),(0,t.jsxs)("button",{onClick:()=>u("desembolso"),className:"bg-red-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-red-600 transition-colors flex items-center space-x-2",children:[(0,t.jsx)(ef.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Nuevo Gasto"})]})]}),0===i.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(eU.Z,{className:"w-12 h-12 text-slate-400 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-slate-600 mb-2",children:"No hay gastos registrados"}),(0,t.jsx)("p",{className:"text-slate-500 text-sm",children:"Los gastos del proyecto aparecer\xe1n aqu\xed"})]}):(0,t.jsx)("div",{className:"space-y-3",children:i.sort((e,a)=>new Date(a.fecha).getTime()-new Date(e.fecha).getTime()).map(e=>(0,t.jsx)("div",{className:"border border-slate-200 rounded-lg p-4",children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,t.jsx)("span",{className:"font-semibold text-slate-800",children:e.descripcion}),(0,t.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("pagado"===e.estado?"bg-emerald-100 text-emerald-700":"aprobado"===e.estado?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:"pagado"===e.estado?"Pagado":"aprobado"===e.estado?"Aprobado":"Pendiente"})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-4 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-slate-500",children:"Monto: "}),(0,t.jsx)("span",{className:"font-bold text-red-600",children:eh(e.monto)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-slate-500",children:"Fecha: "}),(0,t.jsx)("span",{children:y(e.fecha)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-slate-500",children:"Categor\xeda: "}),(0,t.jsx)("span",{children:e.categoriaNombre})]}),e.proveedor&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-slate-500",children:"Proveedor: "}),(0,t.jsx)("span",{children:e.proveedor})]})]})]})})},e.id))})]}),"planPago"===h&&(0,t.jsx)(eY,{proyecto:a,onCrear:m,onCerrar:()=>u(null)}),"pago"===h&&(0,t.jsx)(eH,{proyecto:a,planesPago:r,onRegistrar:x,onCerrar:()=>u(null)}),"desembolso"===h&&(0,t.jsx)(eQ,{proyecto:a,onAgregar:p,onCerrar:()=>u(null)})]})},eX=e=>{let{proyectos:a,clientes:s,planesPago:r,pagos:l,desembolsos:i,onActualizarProyecto:n,onCompletarProyecto:c,onCrearPlanPago:d,onRegistrarPago:m,onAgregarDesembolso:x}=e,[p,h]=(0,o.useState)("lista"),[u,b]=(0,o.useState)(null),[g,j]=(0,o.useState)("todos"),[f,v]=(0,o.useState)(""),N=e=>{let a=K.find(a=>a.value===e);return(null==a?void 0:a.color)||"gray"},y=e=>{let a=K.find(a=>a.value===e);return(null==a?void 0:a.label)||e},w=e=>new Date(e).toLocaleDateString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"}),C=e=>{let a=new Date;return Math.ceil((new Date(e).getTime()-a.getTime())/864e5)},E=e=>{let a=r.filter(a=>a.proyectoId===e.id),s=l.filter(a=>a.proyectoId===e.id),t=i.filter(a=>a.proyectoId===e.id&&"pagado"===a.estado),o=a.reduce((e,a)=>e+a.monto,0),n=s.reduce((e,a)=>e+a.monto,0),c=t.reduce((e,a)=>e+a.monto,0);return{totalPlanificado:o,totalRecibido:n,totalGastado:c,pendienteCobro:o-n,rentabilidadActual:n-c,planesPendientes:a.filter(e=>"pendiente"===e.estado).length,planesVencidos:a.filter(e=>{let a=new Date().toISOString().split("T")[0];return"pendiente"===e.estado&&e.fechaVencimiento<a}).length,porcentajeCobrado:o>0?n/o*100:0}},z=e=>{b(e),h("ver")},S=async(e,a)=>{try{await n(e,{estado:a})}catch(e){console.error("Error al cambiar estado:",e),alert("Error al cambiar el estado del proyecto")}},D=async e=>{if(confirm("\xbfConfirmas que el proyecto est\xe1 completado?"))try{await c(e)}catch(e){console.error("Error al completar proyecto:",e),alert("Error al completar el proyecto")}},P=a.filter(e=>{var a;let s="todos"===g||e.estado===g,t=""===f||e.nombre.toLowerCase().includes(f.toLowerCase())||(null===(a=e.clienteNombre)||void 0===a?void 0:a.toLowerCase().includes(f.toLowerCase()));return s&&t}),_={total:a.length,activos:a.filter(e=>"activo"===e.estado).length,completados:a.filter(e=>"completado"===e.estado).length,valorTotal:a.reduce((e,a)=>e+(a.valorTotal||0),0),rentabilidadTotal:a.reduce((e,a)=>e+E(a).rentabilidadActual,0)};return"ver"===p&&u?(0,t.jsx)(eW,{proyecto:u,clientes:s,planesPago:r.filter(e=>e.proyectoId===u.id),pagos:l.filter(e=>e.proyectoId===u.id),desembolsos:i.filter(e=>e.proyectoId===u.id),onVolver:()=>{h("lista"),b(null)},onActualizarProyecto:n,onCompletarProyecto:c,onCrearPlanPago:d,onRegistrarPago:m,onAgregarDesembolso:x}):(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Total Proyectos"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-slate-800",children:_.total})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center",children:(0,t.jsx)(R.Z,{className:"w-6 h-6 text-blue-600"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Activos"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-emerald-600",children:_.activos})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-emerald-50 rounded-lg flex items-center justify-center",children:(0,t.jsx)(eL.Z,{className:"w-6 h-6 text-emerald-600"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Completados"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:_.completados})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center",children:(0,t.jsx)(ed.Z,{className:"w-6 h-6 text-blue-600"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Rentabilidad Total"}),(0,t.jsx)("p",{className:"text-2xl font-bold ".concat(_.rentabilidadTotal>=0?"text-emerald-600":"text-red-600"),children:eh(Math.abs(_.rentabilidadTotal))})]}),(0,t.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center ".concat(_.rentabilidadTotal>=0?"bg-emerald-50":"bg-red-50"),children:(0,t.jsx)(er.Z,{className:"w-6 h-6 ".concat(_.rentabilidadTotal>=0?"text-emerald-600":"text-red-600")})})]})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsx)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"p-3 bg-indigo-50 rounded-xl",children:(0,t.jsx)(R.Z,{className:"w-6 h-6 text-indigo-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Gesti\xf3n de Proyectos"}),(0,t.jsxs)("p",{className:"text-slate-600",children:[P.length," proyectos"]})]})]})}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(e_.Z,{className:"absolute left-3 top-3 w-5 h-5 text-slate-400"}),(0,t.jsx)("input",{type:"text",value:f,onChange:e=>v(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all",placeholder:"Buscar por nombre o cliente..."})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(eT.Z,{className:"absolute left-3 top-3 w-5 h-5 text-slate-400"}),(0,t.jsxs)("select",{value:g,onChange:e=>j(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-slate-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all appearance-none",children:[(0,t.jsx)("option",{value:"todos",children:"Todos los estados"}),K.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))]})]})]}),0===P.length?(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-slate-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(R.Z,{className:"w-8 h-8 text-slate-400"})}),(0,t.jsx)("p",{className:"text-slate-600 mb-2",children:f||"todos"!==g?"No se encontraron proyectos":"No hay proyectos registrados"}),(0,t.jsx)("p",{className:"text-slate-500 text-sm",children:f||"todos"!==g?"Intenta con otros filtros":"Los proyectos se crean autom\xe1ticamente al aprobar cotizaciones"})]}):(0,t.jsx)("div",{className:"space-y-4",children:P.map(e=>{let a=E(e),s=C(e.fechaFinEstimada),r=s<0&&"activo"===e.estado;return(0,t.jsxs)("div",{className:"border border-slate-200 rounded-xl p-6 hover:shadow-md transition-all",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,t.jsx)("h3",{className:"font-bold text-slate-800 text-lg",children:e.nombre}),(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-".concat(N(e.estado),"-100 text-").concat(N(e.estado),"-700"),children:y(e.estado)}),r&&(0,t.jsxs)("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700 flex items-center space-x-1",children:[(0,t.jsx)(el.Z,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:"Retrasado"})]}),a.planesVencidos>0&&(0,t.jsxs)("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-700",children:[a.planesVencidos," pago",a.planesVencidos>1?"s":""," vencido",a.planesVencidos>1?"s":""]})]}),(0,t.jsxs)("p",{className:"text-slate-600 mb-3",children:["Cliente: ",(0,t.jsx)("span",{className:"font-medium",children:e.clienteNombre})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500",children:"Progreso"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("div",{className:"flex-1 bg-slate-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"bg-emerald-500 h-2 rounded-full transition-all",style:{width:"".concat(e.progreso,"%")}})}),(0,t.jsxs)("span",{className:"font-medium text-slate-700",children:[e.progreso,"%"]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500",children:"Fecha L\xedmite"}),(0,t.jsxs)("p",{className:"font-medium ".concat(r?"text-red-600":"text-slate-700"),children:[w(e.fechaFinEstimada),(0,t.jsxs)("span",{className:"ml-1 text-xs ".concat(s<=7&&s>0?"text-orange-600":r?"text-red-600":"text-slate-500"),children:["(",s>0?"".concat(s," d\xedas"):r?"".concat(Math.abs(s)," d\xedas de retraso"):"Completado",")"]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500",children:"Valor / Cobrado"}),(0,t.jsxs)("p",{className:"font-medium text-slate-700",children:[eh(e.valorTotal)," / ",eh(a.totalRecibido)]}),(0,t.jsx)("div",{className:"w-full bg-slate-200 rounded-full h-1 mt-1",children:(0,t.jsx)("div",{className:"bg-emerald-500 h-1 rounded-full",style:{width:"".concat(Math.min(a.porcentajeCobrado,100),"%")}})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-500",children:"Rentabilidad"}),(0,t.jsxs)("p",{className:"font-bold ".concat(a.rentabilidadActual>=0?"text-emerald-600":"text-red-600"),children:[a.rentabilidadActual>=0?"+":"",eh(a.rentabilidadActual)]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 ml-6",children:[(0,t.jsx)("button",{onClick:()=>z(e),className:"p-2 text-slate-500 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",title:"Ver proyecto",children:(0,t.jsx)(eF.Z,{className:"w-5 h-5"})}),"activo"===e.estado&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>S(e.id,"pausado"),className:"p-2 text-slate-500 hover:text-orange-600 hover:bg-orange-50 rounded-lg transition-colors",title:"Pausar proyecto",children:(0,t.jsx)(eB.Z,{className:"w-5 h-5"})}),(0,t.jsx)("button",{onClick:()=>D(e.id),className:"p-2 text-slate-500 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition-colors",title:"Completar proyecto",children:(0,t.jsx)(ed.Z,{className:"w-5 h-5"})})]}),"pausado"===e.estado&&(0,t.jsx)("button",{onClick:()=>S(e.id,"activo"),className:"p-2 text-slate-500 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition-colors",title:"Reanudar proyecto",children:(0,t.jsx)(eL.Z,{className:"w-5 h-5"})})]})]}),(a.planesPendientes>0||r)&&(0,t.jsx)("div",{className:"border-t border-slate-200 pt-4 mt-4",children:(0,t.jsxs)("div",{className:"flex items-center space-x-4 text-sm",children:[a.planesPendientes>0&&(0,t.jsxs)("div",{className:"flex items-center space-x-1 text-orange-600",children:[(0,t.jsx)(et.Z,{className:"w-4 h-4"}),(0,t.jsxs)("span",{children:[a.planesPendientes," pago",a.planesPendientes>1?"s":""," pendiente",a.planesPendientes>1?"s":""]})]}),r&&(0,t.jsxs)("div",{className:"flex items-center space-x-1 text-red-600",children:[(0,t.jsx)(ei.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Proyecto retrasado"})]})]})})]},e.id)})})]})]})};var eJ=s(2426),e0=s(36454);let e2=e=>{var a,s,r,l,i,n,c,d,m,x,p,h;let{configuracion:u,metas:b,alertas:g,onActualizarConfiguracion:j,onActualizarConfiguracionCompleta:f,onActualizarMetas:v,onActualizarAlertas:N}=e,[y,w]=(0,o.useState)({clave:"",valor:""}),[C,E]=(0,o.useState)({clave:"",valor:""}),[z,S]=(0,o.useState)({clave:"",valor:""}),[D,P]=(0,o.useState)(!1),[_,T]=(0,o.useState)(u),[F,O]=(0,o.useState)(b),[I,A]=(0,o.useState)(g),k=(e,a)=>{T(s=>({...s,porcentajes:{...s.porcentajes,[e]:a}}))},R=e=>{T(a=>{let{[e]:s,...t}=a.porcentajes;return{...a,porcentajes:t}})},V=e=>{T(a=>{let{[e]:s,...t}=a.costosFijos;return{...a,costosFijos:t}})},L=e=>{T(a=>{let{[e]:s,...t}=a.herramientas;return{...a,herramientas:t}})},B=async()=>{P(!0);try{await f(_),await v(F),await N(I),alert("Configuraci\xf3n guardada exitosamente")}catch(e){console.error("Error guardando configuraci\xf3n:",e),alert("Error al guardar la configuraci\xf3n")}finally{P(!1)}};return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,t.jsx)("div",{className:"p-3 bg-slate-50 rounded-xl",children:(0,t.jsx)(M.Z,{className:"w-6 h-6 text-slate-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-slate-800",children:"Configuraci\xf3n del Sistema"}),(0,t.jsx)("p",{className:"text-slate-600",children:"Configura costos, m\xe1rgenes y par\xe1metros operativos"})]})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsxs)("button",{onClick:B,disabled:D,className:"bg-indigo-600 text-white px-6 py-3 rounded-xl font-semibold hover:bg-indigo-700 disabled:bg-slate-300 disabled:cursor-not-allowed transition-colors flex items-center space-x-2",children:[(0,t.jsx)(eg.Z,{className:"w-5 h-5"}),(0,t.jsx)("span",{children:D?"Guardando...":"Guardar Cambios"})]})})]}),(0,t.jsxs)("div",{className:"grid lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,t.jsx)("div",{className:"p-3 bg-red-50 rounded-xl",children:(0,t.jsx)(et.Z,{className:"w-6 h-6 text-red-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Costos Fijos Mensuales"}),(0,t.jsx)("p",{className:"text-slate-600",children:"Gastos operativos del negocio"})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[Object.entries(_.costosFijos).map(e=>{let[a,s]=e;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-medium text-slate-800 capitalize",children:a.replace(/_/g," ")}),(0,t.jsx)("p",{className:"text-sm text-slate-600",children:eh(s)})]}),(0,t.jsx)("button",{onClick:()=>V(a),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:(0,t.jsx)(eN.Z,{className:"w-4 h-4"})})]},a)}),(0,t.jsx)("div",{className:"border-t border-slate-200 pt-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,t.jsx)("input",{type:"text",value:C.clave,onChange:e=>E(a=>({...a,clave:e.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Concepto"}),(0,t.jsx)("input",{type:"text",value:ex(C.valor),onChange:e=>E(a=>({...a,valor:e.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Valor"}),(0,t.jsxs)("button",{onClick:()=>{C.clave&&C.valor&&(T(e=>({...e,costosFijos:{...e.costosFijos,[C.clave]:parseFloat(C.valor.replace(/[^\\d]/g,""))||0}})),E({clave:"",valor:""}))},className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors flex items-center justify-center space-x-1",children:[(0,t.jsx)(ef.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Agregar"})]})]})})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,t.jsx)("div",{className:"p-3 bg-blue-50 rounded-xl",children:(0,t.jsx)(eJ.Z,{className:"w-6 h-6 text-blue-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Porcentajes Operativos"}),(0,t.jsx)("p",{className:"text-slate-600",children:"M\xe1rgenes y porcentajes del negocio"})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[Object.entries(_.porcentajes).map(e=>{let[a,s]=e;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-medium text-slate-800 capitalize",children:a.replace(/_/g," ")}),(0,t.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,t.jsx)("input",{type:"number",value:s,onChange:e=>k(a,parseFloat(e.target.value)||0),className:"w-20 px-2 py-1 border border-slate-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",min:"0",step:"0.1"}),(0,t.jsx)("span",{className:"text-sm text-slate-600",children:"%"})]})]}),(0,t.jsx)("button",{onClick:()=>R(a),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:(0,t.jsx)(eN.Z,{className:"w-4 h-4"})})]},a)}),(0,t.jsx)("div",{className:"border-t border-slate-200 pt-4",children:(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,t.jsx)("input",{type:"text",value:y.clave,onChange:e=>w(a=>({...a,clave:e.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Concepto"}),(0,t.jsx)("input",{type:"number",value:y.valor,onChange:e=>w(a=>({...a,valor:e.target.value})),className:"px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Porcentaje"}),(0,t.jsxs)("button",{onClick:()=>{y.clave&&y.valor&&(T(e=>({...e,porcentajes:{...e.porcentajes,[y.clave]:parseFloat(y.valor)||0}})),w({clave:"",valor:""}))},className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center space-x-1",children:[(0,t.jsx)(ef.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Agregar"})]})]})})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,t.jsx)("div",{className:"p-3 bg-purple-50 rounded-xl",children:(0,t.jsx)(e0.Z,{className:"w-6 h-6 text-purple-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Herramientas y Equipos"}),(0,t.jsx)("p",{className:"text-slate-600",children:"Costos de herramientas y equipos necesarios"})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:[Object.entries(_.herramientas).map(e=>{let[a,s]=e;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-xl",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-medium text-slate-800 capitalize",children:a.replace(/_/g," ")}),(0,t.jsx)("p",{className:"text-sm text-slate-600",children:eh(s)})]}),(0,t.jsx)("button",{onClick:()=>L(a),className:"p-2 text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:(0,t.jsx)(eN.Z,{className:"w-4 h-4"})})]},a)}),(0,t.jsx)("div",{className:"p-4 border-2 border-dashed border-slate-300 rounded-xl",children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("input",{type:"text",value:z.clave,onChange:e=>S(a=>({...a,clave:e.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm",placeholder:"Nombre"}),(0,t.jsx)("input",{type:"text",value:ex(z.valor),onChange:e=>S(a=>({...a,valor:e.target.value})),className:"w-full px-3 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm",placeholder:"Costo"}),(0,t.jsxs)("button",{onClick:()=>{z.clave&&z.valor&&(T(e=>({...e,herramientas:{...e.herramientas,[z.clave]:parseFloat(z.valor.replace(/[^\\d]/g,""))||0}})),S({clave:"",valor:""}))},className:"w-full bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600 transition-colors text-sm flex items-center justify-center space-x-1",children:[(0,t.jsx)(ef.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Agregar"})]})]})})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,t.jsx)("div",{className:"p-3 bg-emerald-50 rounded-xl",children:(0,t.jsx)(ew.Z,{className:"w-6 h-6 text-emerald-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Informaci\xf3n de la Empresa"}),(0,t.jsx)("p",{className:"text-slate-600",children:"Datos que aparecer\xe1n en cotizaciones y documentos"})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Nombre de la Empresa"}),(0,t.jsx)("input",{type:"text",value:(null===(a=_.empresa)||void 0===a?void 0:a.nombre)||"",onChange:e=>T(a=>({...a,empresa:{...a.empresa,nombre:e.target.value}})),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Mi Empresa SAS"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"NIT/RUT"}),(0,t.jsx)("input",{type:"text",value:(null===(s=_.empresa)||void 0===s?void 0:s.nit)||"",onChange:e=>T(a=>({...a,empresa:{...a.empresa,nit:e.target.value}})),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"123456789-0"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Tel\xe9fono"}),(0,t.jsx)("input",{type:"text",value:(null===(r=_.empresa)||void 0===r?void 0:r.telefono)||"",onChange:e=>T(a=>({...a,empresa:{...a.empresa,telefono:e.target.value}})),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"+57 300 123 4567"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Email"}),(0,t.jsx)("input",{type:"email",value:(null===(l=_.empresa)||void 0===l?void 0:l.email)||"",onChange:e=>T(a=>({...a,empresa:{...a.empresa,email:e.target.value}})),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"contacto@miempresa.com"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Ciudad"}),(0,t.jsx)("input",{type:"text",value:(null===(i=_.empresa)||void 0===i?void 0:i.ciudad)||"",onChange:e=>T(a=>({...a,empresa:{...a.empresa,ciudad:e.target.value}})),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Bogot\xe1, Colombia"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Direcci\xf3n"}),(0,t.jsx)("input",{type:"text",value:(null===(n=_.empresa)||void 0===n?void 0:n.direccion)||"",onChange:e=>T(a=>({...a,empresa:{...a.empresa,direccion:e.target.value}})),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent",placeholder:"Calle 123 #45-67"})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,t.jsx)("div",{className:"p-3 bg-indigo-50 rounded-xl",children:(0,t.jsx)(Z.Z,{className:"w-6 h-6 text-indigo-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:"Configuraci\xf3n de Cotizaciones"}),(0,t.jsx)("p",{className:"text-slate-600",children:"Personaliza el formato y contenido de las cotizaciones"})]})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Validez por defecto (d\xedas)"}),(0,t.jsx)("input",{type:"number",value:(null===(c=_.cotizaciones)||void 0===c?void 0:c.validezDias)||30,onChange:e=>T(a=>({...a,cotizaciones:{...a.cotizaciones,validezDias:parseInt(e.target.value)||30}})),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"30",min:"1"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"IVA por defecto (%)"}),(0,t.jsx)("input",{type:"number",value:(null===(d=_.cotizaciones)||void 0===d?void 0:d.ivaDefecto)||19,onChange:e=>T(a=>({...a,cotizaciones:{...a.cotizaciones,ivaDefecto:parseFloat(e.target.value)||19}})),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"19",min:"0",step:"0.1"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Formato de numeraci\xf3n"}),(0,t.jsx)("input",{type:"text",value:(null===(m=_.cotizaciones)||void 0===m?void 0:m.formatoNumero)||"QUOTE-{YYYY}-{###}",onChange:e=>T(a=>({...a,cotizaciones:{...a.cotizaciones,formatoNumero:e.target.value}})),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"QUOTE-{YYYY}-{###}"}),(0,t.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:["Use ","{YYYY}"," para a\xf1o, ","{###}"," para n\xfamero consecutivo"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("input",{type:"checkbox",id:"mostrarLogo",checked:(null===(x=_.cotizaciones)||void 0===x?void 0:x.mostrarLogo)||!1,onChange:e=>T(a=>({...a,cotizaciones:{...a.cotizaciones,mostrarLogo:e.target.checked}})),className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-slate-300 rounded"}),(0,t.jsx)("label",{htmlFor:"mostrarLogo",className:"text-sm font-medium text-slate-700",children:"Mostrar logo en PDF"})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"T\xe9rminos y condiciones por defecto"}),(0,t.jsx)("textarea",{value:(null===(p=_.cotizaciones)||void 0===p?void 0:p.terminosCondiciones)||"1. Validez de la cotizaci\xf3n: 30 d\xedas a partir de la fecha de emisi\xf3n.\n2. Forma de pago: 50% anticipo, 50% contra entrega.\n3. Los precios no incluyen IVA.\n4. Cualquier trabajo adicional ser\xe1 cotizado por separado.\n5. El tiempo de entrega est\xe1 sujeto a la aprobaci\xf3n de la cotizaci\xf3n.",onChange:e=>T(a=>({...a,cotizaciones:{...a.cotizaciones,terminosCondiciones:e.target.value}})),rows:6,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none",placeholder:"Ingrese los t\xe9rminos y condiciones..."})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Nota al pie del PDF"}),(0,t.jsx)("input",{type:"text",value:(null===(h=_.cotizaciones)||void 0===h?void 0:h.notaPie)||"Gracias por confiar en nosotros",onChange:e=>T(a=>({...a,cotizaciones:{...a.cotizaciones,notaPie:e.target.value}})),className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"Gracias por confiar en nosotros"})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800 mb-6",children:"Configuraci\xf3n General"}),(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Ventas Estimadas Mensuales"}),(0,t.jsx)("input",{type:"text",value:ex(_.ventasEstimadas.toString()),onChange:e=>T(a=>({...a,ventasEstimadas:parseFloat(e.target.value.replace(/[^\\d]/g,""))||0})),className:"w-full max-w-md px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"5000000"})]})})]})]})};var e6=s(52217),e5=s(64715),e1=s(9984),e3=s(67017),e4=s(25615),e8=s(41978),e7=s(7657),e9=s(77370),ae=s(67521),aa=s(93584),as=s(14489),at=s(66235),ar=s(6161),al=s(38973);let ao=["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4","#84CC16","#F97316","#EC4899","#6366F1"],ai=e=>{var a;let{clientes:s,servicios:r,cotizaciones:l,proyectos:i,pagos:n,desembolsos:c,metricas:d}=e,[m,x]=(0,o.useState)("rentabilidad"),[p,h]=(0,o.useState)({desde:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],hasta:new Date().toISOString().split("T")[0]}),u=(0,o.useMemo)(()=>i.map(e=>({nombre:e.nombre.length>20?e.nombre.substring(0,20)+"...":e.nombre,valorTotal:e.valorTotal,costoReal:e.costoReal||0,rentabilidad:e.valorTotal-(e.costoReal||0),rentabilidadPorcentaje:e.valorTotal>0?(e.valorTotal-(e.costoReal||0))/e.valorTotal*100:0})),[i]),b=(0,o.useMemo)(()=>r.map(e=>(l.filter(a=>{var s;return null===(s=a.items)||void 0===s?void 0:s.some(a=>a.servicioId===e.id)}).length,{nombre:e.nombre,categoria:e.categoria,vecesCotizado:e.vecesCotizado||0,vecesVendido:e.vecesVendido||0,precio:parseFloat(e.precioSugerido),ingresoTotal:(e.vecesVendido||0)*parseFloat(e.precioSugerido)})).sort((e,a)=>a.ingresoTotal-e.ingresoTotal),[r,l]),g=(0,o.useMemo)(()=>s.map(e=>{let a=i.filter(a=>a.clienteId===e.id),s=a.reduce((e,a)=>e+a.valorTotal,0),t=n.filter(e=>a.some(a=>a.id===e.proyectoId)).reduce((e,a)=>e+a.monto,0);return{nombre:e.nombre,empresa:e.empresa||"Sin empresa",proyectos:a.length,valorTotal:s,totalPagado:t,pendiente:s-t}}).sort((e,a)=>a.valorTotal-e.valorTotal),[s,i,n]),j=(0,o.useMemo)(()=>{let e=[];for(let a=5;a>=0;a--){let s=new Date;s.setMonth(s.getMonth()-a);let t="".concat(s.getFullYear(),"-").concat(String(s.getMonth()+1).padStart(2,"0")),r=n.filter(e=>e.fecha.startsWith(t)),l=c.filter(e=>e.fecha.startsWith(t)),o=r.reduce((e,a)=>e+a.monto,0),i=l.reduce((e,a)=>e+a.monto,0);e.push({mes:s.toLocaleDateString("es-ES",{month:"short",year:"2-digit"}),ingresos:o,gastos:i,flujo:o-i})}return e},[n,c]),f=(0,o.useMemo)(()=>["activo","pausado","completado","cancelado"].map(e=>({estado:e.charAt(0).toUpperCase()+e.slice(1),cantidad:i.filter(a=>a.estado===e).length,valor:i.filter(a=>a.estado===e).reduce((e,a)=>e+a.valorTotal,0)})),[i]),v=(0,o.useMemo)(()=>{let e=[];for(let a=11;a>=0;a--){let s=new Date;s.setMonth(s.getMonth()-a);let t="".concat(s.getFullYear(),"-").concat(String(s.getMonth()+1).padStart(2,"0")),r=l.filter(e=>e.fecha.startsWith(t)),o=r.filter(e=>"aprobada"===e.estado).length,i=r.length;e.push({mes:s.toLocaleDateString("es-ES",{month:"short"}),cotizaciones:i,aprobadas:o,conversion:i>0?o/i*100:0})}return e},[l]),N=[{id:"rentabilidad",label:"Rentabilidad",icon:et.Z,color:"text-emerald-600"},{id:"servicios",label:"Servicios",icon:V.Z,color:"text-blue-600"},{id:"clientes",label:"Clientes",icon:A.Z,color:"text-purple-600"},{id:"flujo",label:"Flujo de Caja",icon:er.Z,color:"text-indigo-600"},{id:"proyectos",label:"Proyectos",icon:Z.Z,color:"text-orange-600"},{id:"tendencias",label:"Tendencias",icon:e6.Z,color:"text-pink-600"}];return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-xl",children:(0,t.jsx)(V.Z,{className:"w-6 h-6 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-slate-800",children:"Reportes y An\xe1lisis"}),(0,t.jsx)("p",{className:"text-slate-600",children:"Insights detallados de tu negocio de servicios"})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(ei.Z,{className:"w-4 h-4 text-slate-500"}),(0,t.jsx)("input",{type:"date",value:p.desde,onChange:e=>h(a=>({...a,desde:e.target.value})),className:"px-3 py-1 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}),(0,t.jsx)("span",{className:"text-slate-500",children:"-"}),(0,t.jsx)("input",{type:"date",value:p.hasta,onChange:e=>h(a=>({...a,hasta:e.target.value})),className:"px-3 py-1 border border-slate-300 rounded-lg text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),(0,t.jsxs)("button",{onClick:()=>{let e=new eZ.ZP,a=new Date().toLocaleDateString("es-ES");switch(e.setFontSize(18),e.text("Reporte de Servicios - Rentability Pro",20,20),e.setFontSize(12),e.text("Fecha: ".concat(a),20,30),e.text("Tipo: ".concat(m.charAt(0).toUpperCase()+m.slice(1)),20,40),m){case"rentabilidad":e.text("Rentabilidad por Proyecto",20,50);let s=u.map(e=>[e.nombre,eh(e.valorTotal),eh(e.costoReal),eh(e.rentabilidad),"".concat(e.rentabilidadPorcentaje.toFixed(1),"%")]);e.autoTable({head:[["Proyecto","Valor Total","Costo Real","Rentabilidad","%"]],body:s,startY:60});break;case"servicios":e.text("An\xe1lisis de Servicios",20,50);let t=b.slice(0,10).map(e=>[e.nombre,e.categoria,e.vecesCotizado.toString(),e.vecesVendido.toString(),eh(e.ingresoTotal)]);e.autoTable({head:[["Servicio","Categor\xeda","Cotizaciones","Ventas","Ingresos"]],body:t,startY:60});break;case"clientes":e.text("An\xe1lisis de Clientes",20,50);let r=g.slice(0,10).map(e=>[e.nombre,e.empresa,e.proyectos.toString(),eh(e.valorTotal),eh(e.totalPagado)]);e.autoTable({head:[["Cliente","Empresa","Proyectos","Valor Total","Pagado"]],body:r,startY:60})}e.save("reporte-".concat(m,"-").concat(a.replace(/\//g,"-"),".pdf"))},className:"bg-indigo-600 text-white px-4 py-2 rounded-xl font-medium hover:bg-indigo-700 transition-colors flex items-center space-x-2",children:[(0,t.jsx)(ek.Z,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Exportar PDF"})]})]})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:N.map(e=>{let a=e.icon,s=m===e.id;return(0,t.jsxs)("button",{onClick:()=>x(e.id),className:"p-4 rounded-xl border-2 transition-all duration-200 ".concat(s?"border-indigo-500 bg-indigo-50 shadow-lg scale-105":"border-slate-200 bg-white hover:border-slate-300 hover:shadow-md"),children:[(0,t.jsx)(a,{className:"w-6 h-6 mx-auto mb-2 ".concat(s?"text-indigo-600":e.color)}),(0,t.jsx)("p",{className:"text-sm font-medium ".concat(s?"text-indigo-800":"text-slate-700"),children:e.label})]},e.id)})})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Total Proyectos"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-slate-800",children:i.length})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-blue-50 rounded-lg flex items-center justify-center",children:(0,t.jsx)(Z.Z,{className:"w-6 h-6 text-blue-600"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Servicios Activos"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-slate-800",children:r.filter(e=>e.activo).length})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-emerald-50 rounded-lg flex items-center justify-center",children:(0,t.jsx)(V.Z,{className:"w-6 h-6 text-emerald-600"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Clientes Registrados"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-slate-800",children:s.length})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-purple-50 rounded-lg flex items-center justify-center",children:(0,t.jsx)(A.Z,{className:"w-6 h-6 text-purple-600"})})]})}),(0,t.jsx)("div",{className:"bg-white rounded-xl p-6 border border-slate-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-slate-600 text-sm",children:"Ingresos del Mes"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-slate-800",children:d?eh(d.ingresosMes):eh(0)})]}),(0,t.jsx)("div",{className:"w-12 h-12 bg-indigo-50 rounded-lg flex items-center justify-center",children:(0,t.jsx)(et.Z,{className:"w-6 h-6 text-indigo-600"})})]})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:[null===(a=N.find(e=>e.id===m))||void 0===a?void 0:a.label," - An\xe1lisis Visual"]}),(0,t.jsxs)("p",{className:"text-slate-600",children:["Visualizaci\xf3n interactiva de datos de ",m]})]}),(0,t.jsx)("div",{className:"w-full",children:(()=>{switch(m){case"rentabilidad":return(0,t.jsx)(e5.h,{width:"100%",height:400,children:(0,t.jsxs)(e1.v,{data:u.slice(0,10),children:[(0,t.jsx)(e3.q,{strokeDasharray:"3 3"}),(0,t.jsx)(e4.K,{dataKey:"nombre",angle:-45,textAnchor:"end",height:100}),(0,t.jsx)(e8.Q,{tickFormatter:e=>eh(e)}),(0,t.jsx)(e7.u,{formatter:e=>eh(Number(e))}),(0,t.jsx)(e9.$,{dataKey:"valorTotal",fill:"#3B82F6",name:"Valor Total"}),(0,t.jsx)(e9.$,{dataKey:"costoReal",fill:"#EF4444",name:"Costo Real"}),(0,t.jsx)(e9.$,{dataKey:"rentabilidad",fill:"#10B981",name:"Rentabilidad"})]})});case"servicios":return(0,t.jsx)(e5.h,{width:"100%",height:400,children:(0,t.jsxs)(ae.u,{children:[(0,t.jsx)(aa.b,{data:b.slice(0,8),cx:"50%",cy:"50%",outerRadius:120,dataKey:"ingresoTotal",nameKey:"nombre",children:b.slice(0,8).map((e,a)=>(0,t.jsx)(as.b,{fill:ao[a%ao.length]},"cell-".concat(a)))}),(0,t.jsx)(e7.u,{formatter:e=>eh(Number(e))})]})});case"clientes":return(0,t.jsx)(e5.h,{width:"100%",height:400,children:(0,t.jsxs)(e1.v,{data:g.slice(0,10),children:[(0,t.jsx)(e3.q,{strokeDasharray:"3 3"}),(0,t.jsx)(e4.K,{dataKey:"nombre",angle:-45,textAnchor:"end",height:100}),(0,t.jsx)(e8.Q,{tickFormatter:e=>eh(e)}),(0,t.jsx)(e7.u,{formatter:e=>eh(Number(e))}),(0,t.jsx)(e9.$,{dataKey:"valorTotal",fill:"#8B5CF6",name:"Valor Total"}),(0,t.jsx)(e9.$,{dataKey:"totalPagado",fill:"#10B981",name:"Total Pagado"})]})});case"flujo":return(0,t.jsx)(e5.h,{width:"100%",height:400,children:(0,t.jsxs)(at.c,{data:j,children:[(0,t.jsx)(e3.q,{strokeDasharray:"3 3"}),(0,t.jsx)(e4.K,{dataKey:"mes"}),(0,t.jsx)(e8.Q,{tickFormatter:e=>eh(e)}),(0,t.jsx)(e7.u,{formatter:e=>eh(Number(e))}),(0,t.jsx)(ar.uN,{type:"monotone",dataKey:"ingresos",stackId:"1",stroke:"#10B981",fill:"#10B981",name:"Ingresos"}),(0,t.jsx)(ar.uN,{type:"monotone",dataKey:"gastos",stackId:"2",stroke:"#EF4444",fill:"#EF4444",name:"Gastos"}),(0,t.jsx)(al.x,{type:"monotone",dataKey:"flujo",stroke:"#3B82F6",strokeWidth:3,name:"Flujo Neto"})]})});case"proyectos":return(0,t.jsx)(e5.h,{width:"100%",height:400,children:(0,t.jsxs)(ae.u,{children:[(0,t.jsx)(aa.b,{data:f,cx:"50%",cy:"50%",outerRadius:120,dataKey:"cantidad",nameKey:"estado",children:f.map((e,a)=>(0,t.jsx)(as.b,{fill:ao[a]},"cell-".concat(a)))}),(0,t.jsx)(e7.u,{})]})});case"tendencias":return(0,t.jsx)(e5.h,{width:"100%",height:400,children:(0,t.jsxs)(at.c,{data:v,children:[(0,t.jsx)(e3.q,{strokeDasharray:"3 3"}),(0,t.jsx)(e4.K,{dataKey:"mes"}),(0,t.jsx)(e8.Q,{yAxisId:"left"}),(0,t.jsx)(e8.Q,{yAxisId:"right",orientation:"right"}),(0,t.jsx)(e7.u,{}),(0,t.jsx)(e9.$,{yAxisId:"left",dataKey:"cotizaciones",fill:"#3B82F6",name:"Cotizaciones"}),(0,t.jsx)(e9.$,{yAxisId:"left",dataKey:"aprobadas",fill:"#10B981",name:"Aprobadas"}),(0,t.jsx)(al.x,{yAxisId:"right",type:"monotone",dataKey:"conversion",stroke:"#F59E0B",strokeWidth:3,name:"% Conversi\xf3n"})]})});default:return(0,t.jsx)("div",{children:"Selecciona un tipo de reporte"})}})()})]})]})};var an=s(9475),ac=s(43765);let ad=()=>{let{clientes:e,servicios:a,cotizaciones:s,proyectos:r,planesPago:l,pagos:o,desembolsos:i,loading:n,error:c}=O(),d=[{name:"Conexi\xf3n a Base de Datos",status:!n&&!c,details:c||"Conectado correctamente"},{name:"Clientes Cargados",status:e.length>0,details:"".concat(e.length," clientes encontrados")},{name:"Servicios Disponibles",status:a.length>0,details:"".concat(a.length," servicios encontrados")},{name:"Cotizaciones en Sistema",status:!0,details:"".concat(s.length," cotizaciones encontradas")},{name:"Proyectos Activos",status:!0,details:"".concat(r.length," proyectos encontrados")},{name:"Planes de Pago",status:!0,details:"".concat(l.length," planes encontrados")},{name:"Pagos Registrados",status:!0,details:"".concat(o.length," pagos encontrados")},{name:"Desembolsos",status:!0,details:"".concat(i.length," desembolsos encontrados")}],m={borrador:s.filter(e=>"borrador"===e.estado).length,enviada:s.filter(e=>"enviada"===e.estado).length,aprobada:s.filter(e=>"aprobada"===e.estado).length,rechazada:s.filter(e=>"rechazada"===e.estado).length},x={activo:r.filter(e=>"activo"===e.estado).length,pausado:r.filter(e=>"pausado"===e.estado).length,completado:r.filter(e=>"completado"===e.estado).length,cancelado:r.filter(e=>"cancelado"===e.estado).length};return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-slate-800 mb-6",children:"Estado del Sistema"}),(0,t.jsx)("div",{className:"grid md:grid-cols-2 gap-4",children:d.map((e,a)=>(0,t.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-slate-50 rounded-xl",children:[e.status?(0,t.jsx)(ed.Z,{className:"w-5 h-5 text-emerald-600"}):(0,t.jsx)(an.Z,{className:"w-5 h-5 text-red-600"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-slate-800",children:e.name}),(0,t.jsx)("p",{className:"text-sm ".concat(e.status?"text-emerald-600":"text-red-600"),children:e.details})]})]},a))})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800 mb-6",children:"Estados de Cotizaciones"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"Borradores:"}),(0,t.jsx)("span",{className:"font-semibold",children:m.borrador})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"Enviadas:"}),(0,t.jsx)("span",{className:"font-semibold text-blue-600",children:m.enviada})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"Aprobadas:"}),(0,t.jsx)("span",{className:"font-semibold text-emerald-600",children:m.aprobada})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"Rechazadas:"}),(0,t.jsx)("span",{className:"font-semibold text-red-600",children:m.rechazada})]})]}),m.borrador>0&&(0,t.jsx)("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:(0,t.jsx)("p",{className:"text-sm text-slate-600",children:"✅ Las cotizaciones en borrador deben mostrar bot\xf3n de eliminar"})}),m.enviada>0&&(0,t.jsx)("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:(0,t.jsx)("p",{className:"text-sm text-blue-700",children:"✅ Las cotizaciones enviadas deben mostrar botones de aprobar/rechazar"})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800 mb-6",children:"Estados de Proyectos"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"Activos:"}),(0,t.jsx)("span",{className:"font-semibold text-emerald-600",children:x.activo})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"Pausados:"}),(0,t.jsx)("span",{className:"font-semibold text-yellow-600",children:x.pausado})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"Completados:"}),(0,t.jsx)("span",{className:"font-semibold text-blue-600",children:x.completado})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-slate-600",children:"Cancelados:"}),(0,t.jsx)("span",{className:"font-semibold text-red-600",children:x.cancelado})]})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8",children:[(0,t.jsx)("h2",{className:"text-xl font-bold text-slate-800 mb-6",children:"Funcionalidades Implementadas"}),(0,t.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:["PDF de cotizaciones","Eliminaci\xf3n de cotizaciones","Aprobaci\xf3n autom\xe1tica","Creaci\xf3n de proyectos","Planes de pago","Registro de pagos","Control de desembolsos","M\xe9tricas en tiempo real","Estados de seguimiento"].map((e,a)=>(0,t.jsxs)("div",{className:"flex items-center space-x-2 p-3 bg-emerald-50 rounded-lg",children:[(0,t.jsx)(ed.Z,{className:"w-4 h-4 text-emerald-600"}),(0,t.jsx)("span",{className:"text-emerald-800 text-sm font-medium",children:e})]},a))})]}),(0,t.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-2xl p-8",children:(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)(ac.Z,{className:"w-6 h-6 text-yellow-600 mt-1"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-yellow-800 mb-2",children:"C\xf3mo Probar las Funcionalidades"}),(0,t.jsxs)("div",{className:"space-y-2 text-yellow-700",children:[(0,t.jsxs)("p",{children:["• ",(0,t.jsx)("strong",{children:"PDF:"})," Abre cualquier cotizaci\xf3n y busca el bot\xf3n de descarga (↓)"]}),(0,t.jsxs)("p",{children:["• ",(0,t.jsx)("strong",{children:"Eliminar:"}),' En cotizaciones con estado "Borrador", aparece bot\xf3n de papelera']}),(0,t.jsxs)("p",{children:["• ",(0,t.jsx)("strong",{children:"Aprobar:"}),' En cotizaciones "Enviadas", aparece bot\xf3n verde de check']}),(0,t.jsxs)("p",{children:["• ",(0,t.jsx)("strong",{children:"Planes de Pago:"}),' En proyectos, busca la secci\xf3n "Planes de Pago" con bot\xf3n +']}),(0,t.jsxs)("p",{children:["• ",(0,t.jsx)("strong",{children:"Configuraci\xf3n:"}),' Ve a Configuraci\xf3n y busca la pesta\xf1a "Cotizaciones"']})]})]})]})})]})},am=()=>{let{clientes:e,servicios:a,cotizaciones:s,proyectos:r,planesPago:l,pagos:i,categoriasDesembolso:n,desembolsos:c,configuracion:d,metas:m,alertas:x,metricas:p,loading:h,error:u,agregarCliente:b,actualizarCliente:g,eliminarCliente:j,agregarServicio:f,actualizarServicio:v,eliminarServicio:N,agregarCotizacion:y,actualizarCotizacion:w,aprobarCotizacion:C,rechazarCotizacion:E,eliminarCotizacion:z,actualizarProyecto:S,completarProyecto:D,crearPlanPago:P,crearPlanesPago:_,actualizarPlanPago:T,registrarPago:F,eliminarPago:G,agregarCategoriaDesembolso:q,agregarDesembolso:Y,actualizarDesembolso:K,eliminarDesembolso:H,actualizarConfiguracion:$,actualizarConfiguracionCompleta:Q,eliminarConfiguracion:X,actualizarMeta:J,actualizarAlerta:ee}=O(),{manejarCambioNumerico:es}=U(),[et,er]=(0,o.useState)("dashboard"),[el,eo]=(0,o.useState)(!1),[ei,en]=(0,o.useState)(W),[ec,ed]=(0,o.useState)(null),em=[{id:"dashboard",label:"Dashboard",icon:I.Z,color:"text-indigo-600",bgColor:"bg-indigo-50"},{id:"clientes",label:"Clientes",icon:A.Z,color:"text-purple-600",bgColor:"bg-purple-50"},{id:"servicios",label:"Servicios",icon:k.Z,color:"text-blue-600",bgColor:"bg-blue-50"},{id:"cotizaciones",label:"Cotizaciones",icon:Z.Z,color:"text-emerald-600",bgColor:"bg-emerald-50"},{id:"proyectos",label:"Proyectos",icon:R.Z,color:"text-orange-600",bgColor:"bg-orange-50"},{id:"reportes",label:"Reportes",icon:V.Z,color:"text-pink-600",bgColor:"bg-pink-50"},{id:"configuracion",label:"Configuraci\xf3n",icon:M.Z,color:"text-gray-600",bgColor:"bg-gray-50"},{id:"debug",label:"\uD83D\uDD0D Debug Sistema",icon:M.Z,color:"text-red-600",bgColor:"bg-red-50"}],ex=em.find(e=>e.id===et),ep=(e,a)=>{["costoBase","gastosFijos","duracionEstimada","precioPorHora"].includes(e)?es(a,a=>{en(s=>({...s,[e]:a}))}):"activo"===e?en(s=>({...s,[e]:"true"===a})):en(s=>({...s,[e]:a}))},eh=()=>{if("por_horas"===ei.tipoServicio)return;let e=ea(parseFloat(ei.costoBase)||0,parseFloat(ei.gastosFijos)||0,parseFloat(ei.margenDeseado)||35,d);en(a=>({...a,precioSugerido:e.toString()}))},eb=async()=>{if(ei.nombre&&(ei.costoBase||"por_horas"===ei.tipoServicio))try{await f(ei),en(W)}catch(e){console.error("Error agregando servicio:",e),alert("Error al agregar el servicio")}},eg=e=>{let s=a.find(a=>a.id===e);s&&(en({nombre:s.nombre,categoria:s.categoria,descripcion:s.descripcion||"",costoBase:s.costoBase,gastosFijos:s.gastosFijos,margenDeseado:s.margenDeseado,precioSugerido:s.precioSugerido,duracionEstimada:s.duracionEstimada.toString(),tipoServicio:s.tipoServicio,precioPorHora:s.precioPorHora||"",recursosNecesarios:s.recursosNecesarios||"",activo:s.activo}),ed(e))},ej=async()=>{if(ec)try{await v(ec,ei),en(W),ed(null)}catch(e){console.error("Error actualizando servicio:",e),alert("Error al actualizar el servicio")}},ef=async e=>{if(confirm("\xbfEst\xe1s seguro de eliminar este servicio?"))try{await N(e)}catch(e){console.error("Error eliminando servicio:",e),alert("Error al eliminar el servicio")}},ev=()=>{en(W),ed(null)},eN=async e=>{try{if(e.porcentajes){for(let a of Object.keys(d.porcentajes))a in e.porcentajes||await X("porcentaje",a);for(let[a,s]of Object.entries(e.porcentajes))await $("porcentaje",a,s)}if(e.costosFijos){for(let a of Object.keys(d.costosFijos))a in e.costosFijos||await X("costo_fijo",a);for(let[a,s]of Object.entries(e.costosFijos))await $("costo_fijo",a,s)}if(e.herramientas){for(let a of Object.keys(d.herramientas))a in e.herramientas||await X("herramienta",a);for(let[a,s]of Object.entries(e.herramientas))await $("herramienta",a,s)}void 0!==e.ventasEstimadas&&await $("general","ventas_estimadas",e.ventasEstimadas)}catch(e){console.error("Error actualizando configuraci\xf3n:",e),alert("Error al actualizar la configuraci\xf3n")}},ew=async e=>{try{void 0!==e.ventasMensuales&&await J("ventas_mensuales",e.ventasMensuales),void 0!==e.unidadesMensuales&&await J("unidades_mensuales",e.unidadesMensuales),void 0!==e.margenPromedio&&await J("margen_promedio",e.margenPromedio),void 0!==e.rotacionInventario&&await J("rotacion_inventario",e.rotacionInventario)}catch(e){console.error("Error actualizando metas:",e),alert("Error al actualizar las metas")}},eC=async e=>{try{void 0!==e.margenMinimo&&await ee("margen_minimo",e.margenMinimo),void 0!==e.stockMinimo&&await ee("stock_minimo",e.stockMinimo),void 0!==e.diasSinVenta&&await ee("dias_sin_venta",e.diasSinVenta),void 0!==e.diferenciaPrecioCompetencia&&await ee("diferencia_precio_competencia",e.diferenciaPrecioCompetencia)}catch(e){console.error("Error actualizando alertas:",e),alert("Error al actualizar las alertas")}};return h?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-slate-600",children:"Cargando sistema de servicios..."})]})}):u?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"text-red-600 mb-4",children:(0,t.jsx)(k.Z,{className:"w-12 h-12 mx-auto"})}),(0,t.jsx)("p",{className:"text-slate-800 font-semibold mb-2",children:"Error al cargar los datos"}),(0,t.jsx)("p",{className:"text-slate-600",children:u}),(0,t.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"Recargar p\xe1gina"})]})}):(0,t.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[(0,t.jsx)("div",{className:"lg:hidden bg-white/80 backdrop-blur-sm border-b border-slate-200 sticky top-0 z-40",children:(0,t.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-lg flex items-center justify-center shadow-lg",children:(0,t.jsx)(k.Z,{className:"w-4 h-4 text-white"})}),(0,t.jsx)("h1",{className:"text-lg font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Rentability Pro"})]}),(0,t.jsx)("button",{onClick:()=>eo(!el),className:"p-2 rounded-xl bg-slate-100 hover:bg-slate-200 transition-colors",children:(0,t.jsx)(L.Z,{className:"w-5 h-5 text-slate-600"})})]})}),(0,t.jsxs)("div",{className:"flex",children:[el&&(0,t.jsx)("div",{className:"lg:hidden fixed inset-0 bg-black/20 backdrop-blur-sm z-40",onClick:()=>eo(!1)}),(0,t.jsxs)("div",{className:"".concat(el?"translate-x-0":"-translate-x-full"," lg:translate-x-0 fixed lg:static top-0 left-0 z-50 lg:z-auto w-72 h-full lg:h-screen bg-white/90 backdrop-blur-sm border-r border-slate-200 transition-transform duration-300 ease-in-out"),children:[(0,t.jsx)("div",{className:"p-6 border-b border-slate-100",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-xl flex items-center justify-center shadow-lg",children:(0,t.jsx)(k.Z,{className:"w-5 h-5 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Rentability Pro"}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:"Sistema de Servicios"})]})]})}),(0,t.jsx)("nav",{className:"p-4 space-y-2 overflow-y-auto",children:em.map(e=>{let a=e.icon,s=et===e.id;return(0,t.jsxs)("button",{onClick:()=>{er(e.id),eo(!1)},className:"w-full flex items-center space-x-3 px-4 py-3 rounded-xl transition-all duration-200 group ".concat(s?"".concat(e.bgColor," ").concat(e.color," shadow-md scale-105"):"text-slate-600 hover:bg-slate-50 hover:text-slate-800"),children:[(0,t.jsx)(a,{className:"w-5 h-5"}),(0,t.jsx)("span",{className:"font-medium",children:e.label}),s&&(0,t.jsx)(B.Z,{className:"w-4 h-4 ml-auto"})]},e.id)})})]}),(0,t.jsx)("div",{className:"flex-1 lg:ml-0",children:(0,t.jsxs)("div",{className:"max-w-7xl mx-auto p-4 lg:p-8",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-slate-500 mb-2",children:[(0,t.jsx)(I.Z,{size:16}),(0,t.jsx)(B.Z,{size:16}),(0,t.jsx)("span",{className:"capitalize",children:null==ex?void 0:ex.label})]}),(0,t.jsx)("h1",{className:"text-3xl lg:text-4xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:null==ex?void 0:ex.label})]}),(0,t.jsx)("div",{className:"space-y-8",children:(()=>{switch(et){case"dashboard":default:return(0,t.jsx)(eu,{clientes:e,servicios:a,cotizaciones:s,proyectos:r,planesPago:l,pagos:i,desembolsos:c,metricas:p,configuracion:d,metas:m,alertas:x});case"clientes":return(0,t.jsx)(eD,{clientes:e,onAgregarCliente:b,onActualizarCliente:g,onEliminarCliente:j});case"servicios":return(0,t.jsx)(ey,{servicios:a,servicioActual:ei,editandoId:ec,onCambioInput:ep,onCalcularPrecios:eh,onAgregarServicio:eb,onEditarServicio:eg,onGuardarEdicion:ej,onEliminarServicio:ef,onCancelarEdicion:ev,configuracion:d});case"cotizaciones":return(0,t.jsx)(eM,{cotizaciones:s,clientes:e,servicios:a,configuracion:d,onCrearCotizacion:y,onActualizarCotizacion:w,onAprobarCotizacion:C,onRechazarCotizacion:E,onEliminarCotizacion:z});case"proyectos":return(0,t.jsx)(eX,{proyectos:r,clientes:e,planesPago:l,pagos:i,desembolsos:c,onActualizarProyecto:S,onCompletarProyecto:D,onCrearPlanPago:P,onRegistrarPago:F,onAgregarDesembolso:Y});case"configuracion":return(0,t.jsx)(e2,{configuracion:d,metas:m,alertas:x,onActualizarConfiguracion:eN,onActualizarConfiguracionCompleta:Q,onActualizarMetas:ew,onActualizarAlertas:eC});case"reportes":return(0,t.jsx)(ai,{clientes:e,servicios:a,cotizaciones:s,proyectos:r,pagos:i,desembolsos:c,metricas:p});case"debug":return(0,t.jsx)(ad,{})}})()})]})})]})]})};function ax(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(l(),{children:[(0,t.jsx)("title",{children:"Rentability Pro - Sistema de Gesti\xf3n de Servicios"}),(0,t.jsx)("meta",{name:"description",content:"Sistema completo de gesti\xf3n de servicios, cotizaciones y proyectos"}),(0,t.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,t.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,t.jsx)(c,{children:(0,t.jsx)(F,{children:(0,t.jsx)(am,{})})})]})}}},function(e){e.O(0,[847,488,888,774,179],function(){return e(e.s=48312)}),_N_E=e.O()}]);